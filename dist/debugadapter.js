module.exports=function(e){var t={};function r(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(s,n,function(t){return e[t]}.bind(null,n));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=20)}([function(e,t){e.exports=require("events")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("child_process")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(11);!function(e){e[e.Auto=0]="Auto",e[e.Hexidecimal=1]="Hexidecimal",e[e.Decimal=2]="Decimal",e[e.Binary=3]="Binary"}(t.NumberFormat||(t.NumberFormat={}));class n extends s.Event{constructor(e,t){super("adapter-output",{content:e,type:t})}}t.AdapterOutputEvent=n;class i extends s.Event{constructor(e,t,r){super("stopped",{reason:e,threadId:t,allThreadsStopped:r})}}t.StoppedEvent=i;class o extends s.Event{constructor(e){super("swo-configure",e)}}t.SWOConfigureEvent=o;class a extends s.Event{constructor(e,t,r,s={}){super("record-event",{category:e,action:t,label:r,parameters:s})}}t.TelemetryEvent=a,t.calculatePortMask=function(e){if(!e)return 0;let t=0;return e.forEach(e=>{if("advanced"===e.type)for(const r of e.ports)t=(t|1<<r)>>>0;else t=(t|1<<e.port)>>>0}),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=/^[0-7]{3}/;class n{static valueOf(e,t){if(!e)return;const r=/^\.?([a-zA-Z_\-][a-zA-Z0-9_\-]*)/,s=/^\[(\d+)\](?:$|\.)/;if(!(t=t.trim()))return e;let n=e;do{let e=r.exec(t);if(e){if(t=t.substr(e[0].length),!n.length||"string"==typeof n)return;{const t=[];for(const r of n)r[0]===e[1]&&t.push(r[1]);if(t.length>1)n=t;else{if(1!==t.length)return;n=t[0]}}}else if("@"===t[0])n=[n],t=t.substr(1);else{if(e=s.exec(t),!e)return;{t=t.substr(e[0].length);const r=parseInt(e[1]);if(n.length&&"string"!=typeof n&&r>=0&&r<n.length)n=n[r];else if(0!==r)return}}t=t.trim()}while(t);return n}constructor(e,t,r){this.token=e,this.outOfBandRecord=t,this.resultRecords=r}record(e){if(this.outOfBandRecord)return n.valueOf(this.outOfBandRecord[0].output,e)}result(e){if(this.resultRecords)return n.valueOf(this.resultRecords.results,e)}}t.MINode=n;const i=/^(?:(\d*|undefined)([\*\+\=])|([\~\@\&]))/,o=/^(\d*)\^(done|running|connected|error|exit)/,a=/^\r\n?/,u=/^([a-zA-Z_\-][a-zA-Z0-9_\-]*)/,c=/^(.*?),/;t.parseMI=function(e){let t;const r=[];let l;const d={"*":"exec","+":"status","=":"notify"},h={"~":"console","@":"target","&":"log"},p=()=>{if('"'!==e[0])return"";let t,r=1,n=!0,i=e.substr(1),o=!1;for(;n;)o?o=!1:"\\"===i[0]?o=!0:'"'===i[0]&&(n=!1),i=i.substr(1),r++;try{t=function(e){const t=Buffer.alloc(4*e.length);let r=0;if('"'!==e[0]||'"'!==e[e.length-1])throw new Error("Not a valid string");e=e.slice(1,-1);let n=!1;for(let i=0;i<e.length;i++)if(n){let o;"\\"===e[i]?r+=t.write("\\",r):'"'===e[i]?r+=t.write('"',r):"'"===e[i]?r+=t.write("'",r):"n"===e[i]?r+=t.write("\n",r):"r"===e[i]?r+=t.write("\r",r):"t"===e[i]?r+=t.write("\t",r):"b"===e[i]?r+=t.write("\b",r):"f"===e[i]?r+=t.write("\f",r):"v"===e[i]?r+=t.write("\v",r):"0"===e[i]?r+=t.write("\0",r):(o=s.exec(e.substr(i)))?(t.writeUInt8(parseInt(o[0],8),r++),i+=2):r+=t.write(e[i],r),n=!1}else if("\\"===e[i])n=!0;else{if('"'===e[i])throw new Error("Not a valid string");r+=t.write(e[i],r)}return t.slice(0,r).toString("utf8")}(e.substr(0,r))}catch(s){t=e.substr(0,r)}return e=e.substr(r),t};let f,m,g,b,v;for(f=()=>'"'===e[0]?p():"{"===e[0]||"["===e[0]?(()=>{if("{"!==e[0]&&"["!==e[0])return;const t="["===e[0];if("}"===(e=e.substr(1))[0]||"]"===e[0])return e=e.substr(1),[];if(t){let t=f();if(t){const r=[];r.push(t);for(;void 0!==(t=g());)r.push(t);return e=e.substr(1),r}}let r=b();if(r){const t=[];for(t.push(r);r=m();)t.push(r);return e=e.substr(1),t}e=(t?"[":"{")+e})():void 0,b=()=>{const t=u.exec(e);if(t)return e=e.substr(t[0].length+1),[t[1],f()]},g=()=>{if(","===e[0])return e=e.substr(1),f()},m=()=>{if(","===e[0])return e=e.substr(1),b()};v=i.exec(e);){if(e=e.substr(v[0].length),v[1]&&void 0===t&&"undefined"!==v[1]&&(t=parseInt(v[1])),v[2]){const t=c.exec(e);e=e.substr(t[1].length);const s={isStream:!1,type:d[v[2]],asyncClass:t[1],output:[]};let n;for(;n=m();)s.output.push(n);r.push(s)}else if(v[3]){const e={isStream:!0,type:h[v[3]],content:p()};r.push(e)}e=e.replace(a,"")}if(v=o.exec(e)){let r;for(e=e.substr(v[0].length),v[1]&&void 0===t&&(t=parseInt(v[1])),l={resultClass:v[2],results:[]};r=m();)l.results.push(r);e=e.replace(a,"")}return new n(t,r||[],l)}},function(e,t,r){e.exports=r(42)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(21),n=r(9),i=r(10),o=r(22);t.Source=class{constructor(e,t,r=0,s,n){this.name=e,this.path=t,this.sourceReference=r,s&&(this.origin=s),n&&(this.adapterData=n)}};t.Scope=class{constructor(e,t,r=!1){this.name=e,this.variablesReference=t,this.expensive=r}};t.StackFrame=class{constructor(e,t,r,s=0,n=0){this.id=e,this.source=r,this.line=s,this.column=n,this.name=t}};t.Thread=class{constructor(e,t){this.id=e,this.name=t||"Thread #"+e}};t.Variable=class{constructor(e,t,r=0,s,n){this.name=e,this.value=t,this.variablesReference=r,"number"==typeof n&&(this.namedVariables=n),"number"==typeof s&&(this.indexedVariables=s)}};t.Breakpoint=class{constructor(e,t,r,s){this.verified=e;const n=this;"number"==typeof t&&(n.line=t),"number"==typeof r&&(n.column=r),s&&(n.source=s)}};t.Module=class{constructor(e,t){this.id=e,this.name=t}};t.CompletionItem=class{constructor(e,t,r=0){this.label=e,this.start=t,this.length=r}};class a extends n.Event{constructor(e,t,r){super("stopped"),this.body={reason:e},"number"==typeof t&&(this.body.threadId=t),"string"==typeof r&&(this.body.text=r)}}t.StoppedEvent=a;class u extends n.Event{constructor(e,t){super("continued"),this.body={threadId:e},"boolean"==typeof t&&(this.body.allThreadsContinued=t)}}t.ContinuedEvent=u;class c extends n.Event{constructor(){super("initialized")}}t.InitializedEvent=c;class l extends n.Event{constructor(e){if(super("terminated"),"boolean"==typeof e||e){this.body={restart:e}}}}t.TerminatedEvent=l;class d extends n.Event{constructor(e,t="console",r){super("output"),this.body={category:t,output:e},void 0!==r&&(this.body.data=r)}}t.OutputEvent=d;class h extends n.Event{constructor(e,t){super("thread"),this.body={reason:e,threadId:t}}}t.ThreadEvent=h;class p extends n.Event{constructor(e,t){super("breakpoint"),this.body={reason:e,breakpoint:t}}}t.BreakpointEvent=p;class f extends n.Event{constructor(e,t){super("module"),this.body={reason:e,module:t}}}t.ModuleEvent=f;class m extends n.Event{constructor(e,t){super("loadedSource"),this.body={reason:e,source:t}}}t.LoadedSourceEvent=m;class g extends n.Event{constructor(e){super("capabilities"),this.body={capabilities:e}}}var b;t.CapabilitiesEvent=g,function(e){e[e.User=1]="User",e[e.Telemetry=2]="Telemetry"}(b=t.ErrorDestination||(t.ErrorDestination={}));class v extends s.ProtocolServer{constructor(e,t){super();const r="boolean"==typeof e&&e;this._debuggerLinesStartAt1=r,this._debuggerColumnsStartAt1=r,this._debuggerPathsAreURIs=!1,this._clientLinesStartAt1=!0,this._clientColumnsStartAt1=!0,this._clientPathsAreURIs=!1,this._isServer="boolean"==typeof t&&t,this.on("close",()=>{this.shutdown()}),this.on("error",e=>{this.shutdown()})}setDebuggerPathFormat(e){this._debuggerPathsAreURIs="path"!==e}setDebuggerLinesStartAt1(e){this._debuggerLinesStartAt1=e}setDebuggerColumnsStartAt1(e){this._debuggerColumnsStartAt1=e}setRunAsServer(e){this._isServer=e}static run(e){let t=0;if(process.argv.slice(2).forEach((function(e,r,s){const n=/^--server=(\d{4,5})$/.exec(e);n&&(t=parseInt(n[1],10))})),t>0)console.error(`waiting for debug protocol on port ${t}`),i.createServer(t=>{console.error(">> accepted connection from client"),t.on("end",()=>{console.error(">> client connection closed\n")});const r=new e(!1,!0);r.setRunAsServer(!0),r.start(t,t)}).listen(t);else{const t=new e(!1);process.on("SIGTERM",()=>{t.shutdown()}),t.start(process.stdin,process.stdout)}}shutdown(){this._isServer||setTimeout(()=>{process.exit(0)},100)}sendErrorResponse(e,t,r,s,n=b.User){let i;"number"==typeof t?(i={id:t,format:r},s&&(i.variables=s),n&b.User&&(i.showUser=!0),n&b.Telemetry&&(i.sendTelemetry=!0)):i=t,e.success=!1,e.message=v.formatPII(i.format,!0,i.variables),e.body||(e.body={}),e.body.error=i,this.sendResponse(e)}runInTerminalRequest(e,t,r){this.sendRequest("runInTerminal",e,t,r)}dispatchRequest(e){const t=new n.Response(e);try{if("initialize"===e.command){var r=e.arguments;if("boolean"==typeof r.linesStartAt1&&(this._clientLinesStartAt1=r.linesStartAt1),"boolean"==typeof r.columnsStartAt1&&(this._clientColumnsStartAt1=r.columnsStartAt1),"path"!==r.pathFormat)this.sendErrorResponse(t,2018,"debug adapter only supports native paths",null,b.Telemetry);else{const e=t;e.body={},this.initializeRequest(e,r)}}else"launch"===e.command?this.launchRequest(t,e.arguments):"attach"===e.command?this.attachRequest(t,e.arguments):"disconnect"===e.command?this.disconnectRequest(t,e.arguments):"terminate"===e.command?this.terminateRequest(t,e.arguments):"restart"===e.command?this.restartRequest(t,e.arguments):"setBreakpoints"===e.command?this.setBreakPointsRequest(t,e.arguments):"setFunctionBreakpoints"===e.command?this.setFunctionBreakPointsRequest(t,e.arguments):"setExceptionBreakpoints"===e.command?this.setExceptionBreakPointsRequest(t,e.arguments):"configurationDone"===e.command?this.configurationDoneRequest(t,e.arguments):"continue"===e.command?this.continueRequest(t,e.arguments):"next"===e.command?this.nextRequest(t,e.arguments):"stepIn"===e.command?this.stepInRequest(t,e.arguments):"stepOut"===e.command?this.stepOutRequest(t,e.arguments):"stepBack"===e.command?this.stepBackRequest(t,e.arguments):"reverseContinue"===e.command?this.reverseContinueRequest(t,e.arguments):"restartFrame"===e.command?this.restartFrameRequest(t,e.arguments):"goto"===e.command?this.gotoRequest(t,e.arguments):"pause"===e.command?this.pauseRequest(t,e.arguments):"stackTrace"===e.command?this.stackTraceRequest(t,e.arguments):"scopes"===e.command?this.scopesRequest(t,e.arguments):"variables"===e.command?this.variablesRequest(t,e.arguments):"setVariable"===e.command?this.setVariableRequest(t,e.arguments):"setExpression"===e.command?this.setExpressionRequest(t,e.arguments):"source"===e.command?this.sourceRequest(t,e.arguments):"threads"===e.command?this.threadsRequest(t):"terminateThreads"===e.command?this.terminateThreadsRequest(t,e.arguments):"evaluate"===e.command?this.evaluateRequest(t,e.arguments):"stepInTargets"===e.command?this.stepInTargetsRequest(t,e.arguments):"gotoTargets"===e.command?this.gotoTargetsRequest(t,e.arguments):"completions"===e.command?this.completionsRequest(t,e.arguments):"exceptionInfo"===e.command?this.exceptionInfoRequest(t,e.arguments):"loadedSources"===e.command?this.loadedSourcesRequest(t,e.arguments):"dataBreakpointInfo"===e.command?this.dataBreakpointInfoRequest(t,e.arguments):"setDataBreakpoints"===e.command?this.setDataBreakpointsRequest(t,e.arguments):"readMemory"===e.command?this.readMemoryRequest(t,e.arguments):"disassemble"===e.command?this.disassembleRequest(t,e.arguments):this.customRequest(e.command,t,e.arguments)}catch(e){this.sendErrorResponse(t,1104,"{_stack}",{_exception:e.message,_stack:e.stack},b.Telemetry)}}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsRestartRequest=!1,e.body.supportsExceptionOptions=!1,e.body.supportsValueFormattingOptions=!1,e.body.supportsExceptionInfoRequest=!1,e.body.supportTerminateDebuggee=!1,e.body.supportsDelayedStackTraceLoading=!1,e.body.supportsLoadedSourcesRequest=!1,e.body.supportsLogPoints=!1,e.body.supportsTerminateThreadsRequest=!1,e.body.supportsSetExpression=!1,e.body.supportsTerminateRequest=!1,e.body.supportsDataBreakpoints=!1,e.body.supportsReadMemoryRequest=!1,e.body.supportsDisassembleRequest=!1,this.sendResponse(e)}disconnectRequest(e,t){this.sendResponse(e),this.shutdown()}launchRequest(e,t){this.sendResponse(e)}attachRequest(e,t){this.sendResponse(e)}terminateRequest(e,t){this.sendResponse(e)}restartRequest(e,t){this.sendResponse(e)}setBreakPointsRequest(e,t){this.sendResponse(e)}setFunctionBreakPointsRequest(e,t){this.sendResponse(e)}setExceptionBreakPointsRequest(e,t){this.sendResponse(e)}configurationDoneRequest(e,t){this.sendResponse(e)}continueRequest(e,t){this.sendResponse(e)}nextRequest(e,t){this.sendResponse(e)}stepInRequest(e,t){this.sendResponse(e)}stepOutRequest(e,t){this.sendResponse(e)}stepBackRequest(e,t){this.sendResponse(e)}reverseContinueRequest(e,t){this.sendResponse(e)}restartFrameRequest(e,t){this.sendResponse(e)}gotoRequest(e,t){this.sendResponse(e)}pauseRequest(e,t){this.sendResponse(e)}sourceRequest(e,t){this.sendResponse(e)}threadsRequest(e){this.sendResponse(e)}terminateThreadsRequest(e,t){this.sendResponse(e)}stackTraceRequest(e,t){this.sendResponse(e)}scopesRequest(e,t){this.sendResponse(e)}variablesRequest(e,t){this.sendResponse(e)}setVariableRequest(e,t){this.sendResponse(e)}setExpressionRequest(e,t){this.sendResponse(e)}evaluateRequest(e,t){this.sendResponse(e)}stepInTargetsRequest(e,t){this.sendResponse(e)}gotoTargetsRequest(e,t){this.sendResponse(e)}completionsRequest(e,t){this.sendResponse(e)}exceptionInfoRequest(e,t){this.sendResponse(e)}loadedSourcesRequest(e,t){this.sendResponse(e)}dataBreakpointInfoRequest(e,t){this.sendResponse(e)}setDataBreakpointsRequest(e,t){this.sendResponse(e)}readMemoryRequest(e,t){this.sendResponse(e)}disassembleRequest(e,t){this.sendResponse(e)}customRequest(e,t,r){this.sendErrorResponse(t,1014,"unrecognized request",null,b.Telemetry)}convertClientLineToDebugger(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e+1:this._clientLinesStartAt1?e-1:e}convertDebuggerLineToClient(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e-1:this._clientLinesStartAt1?e+1:e}convertClientColumnToDebugger(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e+1:this._clientColumnsStartAt1?e-1:e}convertDebuggerColumnToClient(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e-1:this._clientColumnsStartAt1?e+1:e}convertClientPathToDebugger(e){return this._clientPathsAreURIs!==this._debuggerPathsAreURIs?this._clientPathsAreURIs?v.uri2path(e):v.path2uri(e):e}convertDebuggerPathToClient(e){return this._debuggerPathsAreURIs!==this._clientPathsAreURIs?this._debuggerPathsAreURIs?v.uri2path(e):v.path2uri(e):e}static path2uri(e){"win32"===process.platform&&(/^[A-Z]:/.test(e)&&(e=e[0].toLowerCase()+e.substr(1)),e=e.replace(/\\/g,"/")),e=encodeURI(e);let t=new o.URL("file:");return t.pathname=e,t.toString()}static uri2path(e){let t=new o.URL(e),r=decodeURIComponent(t.pathname);return"win32"===process.platform&&(/^\/[a-zA-Z]:/.test(r)&&(r=r[1].toLowerCase()+r.substr(2)),r=r.replace(/\//g,"\\")),r}static formatPII(e,t,r){return e.replace(v._formatPIIRegexp,(function(e,s){return t&&s.length>0&&"_"!==s[0]?e:r[s]&&r.hasOwnProperty(s)?r[s]:e}))}}v._formatPIIRegexp=/{([^}]+)}/g,t.DebugSession=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s{constructor(e){this.seq=0,this.type=e}}t.Message=s;t.Response=class extends s{constructor(e,t){super("response"),this.request_seq=e.seq,this.command=e.command,t?(this.success=!1,this.message=t):this.success=!0}};t.Event=class extends s{constructor(e,t){super("event"),this.event=e,t&&(this.body=t)}}},function(e,t){e.exports=require("net")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(8);t.DebugSession=s.DebugSession,t.InitializedEvent=s.InitializedEvent,t.TerminatedEvent=s.TerminatedEvent,t.StoppedEvent=s.StoppedEvent,t.ContinuedEvent=s.ContinuedEvent,t.OutputEvent=s.OutputEvent,t.ThreadEvent=s.ThreadEvent,t.BreakpointEvent=s.BreakpointEvent,t.ModuleEvent=s.ModuleEvent,t.LoadedSourceEvent=s.LoadedSourceEvent,t.CapabilitiesEvent=s.CapabilitiesEvent,t.Thread=s.Thread,t.StackFrame=s.StackFrame,t.Scope=s.Scope,t.Variable=s.Variable,t.Breakpoint=s.Breakpoint,t.Source=s.Source,t.Module=s.Module,t.CompletionItem=s.CompletionItem,t.ErrorDestination=s.ErrorDestination;const n=r(23);t.LoggingDebugSession=n.LoggingDebugSession;const i=r(12);t.Logger=i;const o=r(9);t.Event=o.Event,t.Response=o.Response;const a=r(25);t.Handles=a.Handles;const u=i.logger;t.logger=u},function(e,t,r){"use strict";var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(n,i){function o(e){try{u(s.next(e))}catch(e){i(e)}}function a(e){try{u(s.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(o,a)}u((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),i=r(1),o=r(24),a=r(8);var u;!function(e){e[e.Verbose=0]="Verbose",e[e.Log=1]="Log",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Stop=4]="Stop"}(u=t.LogLevel||(t.LogLevel={}));class c{constructor(){this._pendingLogQ=[]}log(e,t=u.Log){e+="\n",this._write(e,t)}verbose(e){this.log(e,u.Verbose)}warn(e){this.log(e,u.Warn)}error(e){this.log(e,u.Error)}dispose(){if(this._currentLogger){const e=this._currentLogger.dispose();return this._currentLogger=null,e}return Promise.resolve()}_write(e,t=u.Log){e+="",this._pendingLogQ?this._pendingLogQ.push({msg:e,level:t}):this._currentLogger&&this._currentLogger.log(e,t)}setup(e,t,r=!0){const s="string"==typeof t?t:t&&this._logFilePathFromInit;if(this._currentLogger){const t={consoleMinLogLevel:e,logFilePath:s,prependTimestamp:r};this._currentLogger.setup(t).then(()=>{if(this._pendingLogQ){const e=this._pendingLogQ;this._pendingLogQ=null,e.forEach(e=>this._write(e.msg,e.level))}})}}init(e,t,r){this._pendingLogQ=this._pendingLogQ||[],this._currentLogger=new l(e,r),this._logFilePathFromInit=t}}t.Logger=c,t.logger=new c;class l{constructor(e,t){this.beforeExitCallback=()=>this.dispose(),this._logCallback=e,this._logToConsole=t,this._minLogLevel=u.Warn,this.disposeCallback=(e,t)=>{this.dispose(),t=t||2,t+=128,process.exit(t)}}setup(e){return s(this,void 0,void 0,(function*(){if(this._minLogLevel=e.consoleMinLogLevel,this._prependTimestamp=e.prependTimestamp,e.logFilePath)if(i.isAbsolute(e.logFilePath)){const r=t=>this.sendLog(`Error creating log file at path: ${e.logFilePath}. Error: ${t.toString()}\n`,u.Error);try{yield(t=i.dirname(e.logFilePath),new Promise((e,r)=>{o(t,t=>{t?r(t):e()})})),this.log("Verbose logs are written to:\n",u.Warn),this.log(e.logFilePath+"\n",u.Warn),this._logFileStream=n.createWriteStream(e.logFilePath),this.logDateTime(),this.setupShutdownListeners(),this._logFileStream.on("error",e=>{r(e)})}catch(e){r(e)}}else this.log(`logFilePath must be an absolute path: ${e.logFilePath}`,u.Error);var t}))}logDateTime(){let e=new Date;const t=e.getUTCFullYear()+"-"+`${e.getUTCMonth()+1}`+"-"+e.getUTCDate()+", "+p();this.log(t+"\n",u.Verbose,!1)}setupShutdownListeners(){process.addListener("beforeExit",this.beforeExitCallback),process.addListener("SIGTERM",this.disposeCallback),process.addListener("SIGINT",this.disposeCallback)}removeShutdownListeners(){process.removeListener("beforeExit",this.beforeExitCallback),process.removeListener("SIGTERM",this.disposeCallback),process.removeListener("SIGINT",this.disposeCallback)}dispose(){return new Promise(e=>{this.removeShutdownListeners(),this._logFileStream?(this._logFileStream.end(e),this._logFileStream=null):e()})}log(e,t,r=!0){if(this._minLogLevel!==u.Stop){if(t>=this._minLogLevel&&this.sendLog(e,t),this._logToConsole){const r=t===u.Error?console.error:t===u.Warn?console.warn:null;r&&r(h(e))}t===u.Error&&(e=`[${u[t]}] ${e}`),this._prependTimestamp&&r&&(e="["+p()+"] "+e),this._logFileStream&&this._logFileStream.write(e)}}sendLog(e,t){if(e.length>1500){const t=!!e.match(/(\n|\r\n)$/);e=e.substr(0,1500)+"[...]",t&&(e+="\n")}if(this._logCallback){const r=new d(e,t);this._logCallback(r)}}}class d extends a.OutputEvent{constructor(e,t){super(e,t===u.Error?"stderr":t===u.Warn?"console":"stdout")}}function h(e){return e.replace(/(\n|\r\n)$/,"")}function p(){let e=new Date;return f(2,String(e.getUTCHours()))+":"+f(2,String(e.getUTCMinutes()))+":"+f(2,String(e.getUTCSeconds()))+"."+f(3,String(e.getUTCMilliseconds()))+" UTC"}function f(e,t){return t.length>=e?t:String("0".repeat(e)+t).slice(-e)}t.LogOutputEvent=d,t.trimLastNewline=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(6);t.VariableObject=class{constructor(e){this.name=s.MINode.valueOf(e,"name"),this.exp=s.MINode.valueOf(e,"exp"),this.numchild=parseInt(s.MINode.valueOf(e,"numchild")),this.type=s.MINode.valueOf(e,"type"),this.value=s.MINode.valueOf(e,"value"),this.threadId=s.MINode.valueOf(e,"thread-id"),this.frozen=!!s.MINode.valueOf(e,"frozen"),this.dynamic=!!s.MINode.valueOf(e,"dynamic"),this.displayhint=s.MINode.valueOf(e,"displayhint"),this.children={},this.hasMore=!!s.MINode.valueOf(e,"has_more")}applyChanges(e){this.value=s.MINode.valueOf(e,"value"),s.MINode.valueOf(e,"type_changed")&&(this.type=s.MINode.valueOf(e,"new_type")),this.dynamic=!!s.MINode.valueOf(e,"dynamic"),this.displayhint=s.MINode.valueOf(e,"displayhint"),this.hasMore=!!s.MINode.valueOf(e,"has_more")}isCompound(){return this.numchild>0||"{...}"===this.value||this.dynamic&&("array"===this.displayhint||"map"===this.displayhint)}toProtocolVariable(){const e={name:this.exp,evaluateName:this.fullExp||this.exp,value:void 0===this.value?"<unknown>":this.value,type:this.type,presentationHint:{kind:this.displayhint},variablesReference:this.id};return this.displayhint,e}},t.MIError=class{constructor(e,t){Object.defineProperty(this,"name",{get:()=>this.constructor.name}),Object.defineProperty(this,"message",{get:()=>e}),Object.defineProperty(this,"source",{get:()=>t}),Error.captureStackTrace(this,this.constructor)}toString(){return`${this.message} (from ${this.source})`}},Object.setPrototypeOf(t.MIError,Object.create(Error.prototype)),t.MIError.prototype.constructor=t.MIError},function(e,t){e.exports=require("timers")},function(e,t,r){"use strict";var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(n,i){function o(e){try{u(s.next(e))}catch(e){i(e)}}function a(e){try{u(s.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(o,a)}u((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=r(29),i=r(2),o=r(10),a=r(4),u=r(7);class c{static isPortInUse(e,t){return new Promise((r,s)=>{const n=o.createServer(e=>{});n.once("error",i=>{const o=i.code;o&&"EADDRINUSE"===o||"EACCES"===o?("EACCES"===o&&console.log(`port ${t}:${e} returned code EACCES?`),r(!0)):(console.log(`port ${t}:${e} unexpected error `,i),s(i)),n.close()}),n.listen(e,t,()=>{r(!1),n.close()})})}static isPortInUseEx(e,t){if(c.shouldUseServerMethod(t)){const t=c.getLocalHostAliases();let r=0;return new Promise((s,n)=>{!function e(i,o){c.isPortInUse(i,o).then(n=>{n?s(n):++r===t.length?s(!1):e(i,t[r])}).catch(e=>{n(e)})}(e,t[r])})}return n.check(e,t)}static findFreePorts({min:e,max:t,retrieve:r=1,consecutive:s=!1,doLog:i=!1},o=c.DefaultHost){let a=[];const u=[],l=r,d=c.shouldUseServerMethod(o)?c.isPortInUseEx:n.tcpPortUsed;return new Promise((r,n)=>{l<=0?r(a):function e(o,c){const h=process.hrtime();d(o,c).then(d=>{const p=process.hrtime(h);if(d?u.push(o):(s&&a.length>0&&o!==1+a[a.length-1]&&(i&&console.log("TcpPortHelper.find: Oops, reset for consecutive ports requirement"),a=[]),a.push(o)),i){const e=(p[1]/1e6).toFixed(2),t=`${p[0]}s ${e}ms`;console.log(`TcpPortHelper.find Port ${c}:${o} `+(d?"busy":"free")+`, Found: ${a.length} of ${l} needed ${t}`)}a.length===l?r(a):o<t?e(o+1,c):n(new Error(`Only found ${a.length} of ${l} ports`))}).catch(e=>{n(e)})}(e,o)})}static findFreePortsSync({min:e,max:t,retrieve:r=1,consecutive:i=!1,doLog:o=!1},a=c.DefaultHost,u=null){return s(this,void 0,void 0,(function*(){let s=[];const l=[],d=r;let h=null;if(d<=0)return new Promise(e=>{e(s)});const p=c.shouldUseServerMethod(a)?c.isPortInUseEx:n.tcpPortUsed;for(let r=e;r<=t;r++){if(d<=0)return;const e=process.hrtime();if(yield p(r,a).then(t=>{const n=process.hrtime(e);if(t?l.push(r):(i&&s.length>0&&r!==1+s[s.length-1]&&(o&&console.log("TcpPortHelper.finnd: Oops, reset for consecutive requirement"),s=[]),s.push(r)),o){const e=(n[1]/1e6).toFixed(2),i=`${n[0]}s ${e}ms`;console.log(`TcpPortHelper.find Port ${a}:${r} `+(t?"busy":"free")+`, Found: ${s.length} of ${d} needed `+i)}},e=>{o&&console.error("Error on check:",e.message),h=e}),h||s.length===d)break}return u?(h||s.length!==d||u(s),null):new Promise((e,t)=>{h||s.length!==d?t(h||`Only found ${s.length} of ${d} ports`):e(s)})}))}static getOsNetProbeCmd(){if(""===c.OSNetProbeCmd){const e=u.sync,t=i.platform(),r="win32"===t,s="darwin"===t;r||s||!e("ss")?e("netstat")?(c.OSNetProbeCmd=r?"netstat -nap tcp":"netstat -nap tcp -f inet",c.OSNetProbeCmdRegexpStr="[tT][cC][pP][^\\n]*[:\\.]XYZZY\\s+[^\\s]+\\s+LISTEN[^\\n]*\\n"):s&&e("lsof")?(c.OSNetProbeCmd="lsof -n -iTCP:XYZZY -sTCP:LISTEN",c.OSNetProbeCmdRegexpStr="IPv4[^\\n]+:XYZZY\\s[^\\n]*\\(LISTEN\\)[^\\n]*\\n"):c.OSNetProbeCmd="?":(c.OSNetProbeCmd="ss -nlt",c.OSNetProbeCmdRegexpStr="LISTEN\\s+[^\\n]*:XYZZY\\s+[^\\s]+[^\\n]*\\n")}return c.OSNetProbeCmd}static waitForPortOpenOSUtl(e,t=100,r=5e3,s=!0,n=!0){const i=c.getOsNetProbeCmd().replace("XYZZY",e.toString());if(n&&console.log(i),s&&"?"===i)return c.waitForPortOpen(e,c.DefaultHost,!0,t,r);const o=c.OSNetProbeCmdRegexpStr.replace("XYZZY",e.toString());n&&console.log(o);const u=new RegExp(o),l=Date.now();let d=!0;return t=Math.max(t,1),new Promise((function e(s,o){if("?"===i)return o(new Error("failed"));a.exec(i,(a,c)=>{if(a&&!i.startsWith("lsof"))return o(a);if(u.test(c))return n&&console.log(c.match(u).join("\n")),s();{d&&(d=!1);const i=Date.now()-l;if(!(i<r))return o(new Error("timeout"));n&&console.log(`waitForPortOpenOSUtl: Setting timeout for ${t}ms, curTime = ${i}ms`),setTimeout(()=>{e(s,o)},t)}})}))}static waitForPortStatusEx(e){e.startTimeMs=Date.now();const t=e.checkLocalHostAliases?c.isPortInUseEx:c.isPortInUse;return new Promise((function r(s,n){t(e.port,e.host).then(t=>{if(t===e.desiredStatus)return s();throw new Error("tryagain")}).catch(t=>{if("tryagain"!==t.message)return n(t);if(!(Date.now()-e.startTimeMs<e.timeOutMs))return n(new Error("timeout"));setTimeout(()=>{r(s,n)},e.retryTimeMs)})}))}static waitForPortStatus(e,t=c.DefaultHost,r=!0,s=!0,i=100,o=5e3){if(i=Math.max(i,1),c.shouldUseServerMethod(t)){const n=new l(r,e,t,s,i,o);return c.waitForPortStatusEx(n)}return n.waitForStatus(e,t,r,i,o)}static waitForPortOpen(e,t=c.DefaultHost,r=!0,s=100,i=5e3){if(s=Math.max(s,1),c.shouldUseServerMethod(t)){const n=new l(!0,e,t,r,s,i);return c.waitForPortStatusEx(n)}return n.waitUntilUsedOnHost(e,t,s,i)}static waitForPortClosed(e,t=c.DefaultHost,r=!0,s=100,i=5e3){if(s=Math.max(s,1),c.shouldUseServerMethod(t)){const n=new l(!1,e,t,r,s,i);return c.waitForPortStatusEx(n)}return n.waitUntilFreeOnHost(e,t,s,i)}static getLocalHostAliases(){if(0===c.localHostAliases.length){c.localHostAliases=["0.0.0.0","127.0.0.1",""];const e=i.networkInterfaces();Object.keys(e).forEach(t=>{e[t].forEach(e=>{e.internal&&"ipv4"===e.family.toLowerCase()&&-1===c.localHostAliases.indexOf(e.address)&&c.localHostAliases.push(e.address)})})}return c.localHostAliases}static shouldUseServerMethod(e){return!c.ForceClientMethod&&(!e||"localhost"===e.toLowerCase()||c.getLocalHostAliases().indexOf(e)>=0)}}c.ForceClientMethod=!1,c.DefaultHost="0.0.0.0",c.OSNetProbeCmd="",c.OSNetProbeCmdRegexpStr="",c.localHostAliases=[],t.TcpPortScanner=c;class l{constructor(e,t,r=c.DefaultHost,s=!0,n=100,i=5e3){this.desiredStatus=e,this.port=t,this.host=r,this.checkLocalHostAliases=s,this.retryTimeMs=n,this.timeOutMs=i,this.startTimeMs=0,this.retryTimeMs=Math.max(this.retryTimeMs,1)}}t.PortStatusArgs=l},function(e,t){e.exports=require("util")},function(e,t,r){e.exports=function(e){function t(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return s.colors[Math.abs(t)%s.colors.length]}function s(e){let r;function o(...e){if(!o.enabled)return;const t=o,n=Number(new Date),i=n-(r||n);t.diff=i,t.prev=r,t.curr=n,r=n,e[0]=s.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,n)=>{if("%%"===r)return r;a++;const i=s.formatters[n];if("function"==typeof i){const s=e[a];r=i.call(t,s),e.splice(a,1),a--}return r}),s.formatArgs.call(t,e),(t.log||s.log).apply(t,e)}return o.namespace=e,o.enabled=s.enabled(e),o.useColors=s.useColors(),o.color=t(e),o.destroy=n,o.extend=i,"function"==typeof s.init&&s.init(o),s.instances.push(o),o}function n(){const e=s.instances.indexOf(this);return-1!==e&&(s.instances.splice(e,1),!0)}function i(e,t){return s(this.namespace+(void 0===t?":":t)+e)}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return s.debug=s,s.default=s,s.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},s.disable=function(){const e=[...s.names.map(o),...s.skips.map(o).map(e=>"-"+e)].join(",");return s.enable(""),e},s.enable=function(e){let t;s.save(e),s.names=[],s.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length;for(t=0;t<n;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?s.skips.push(new RegExp("^"+e.substr(1)+"$")):s.names.push(new RegExp("^"+e+"$")));for(t=0;t<s.instances.length;t++){const e=s.instances[t];e.enabled=s.enabled(e.namespace)}},s.enabled=function(e){if("*"===e[e.length-1])return!0;let t,r;for(t=0,r=s.skips.length;t<r;t++)if(s.skips[t].test(e))return!1;for(t=0,r=s.names.length;t<r;t++)if(s.names[t].test(e))return!0;return!1},s.humanize=r(37),Object.keys(e).forEach(t=>{s[t]=e[t]}),s.instances=[],s.names=[],s.skips=[],s.formatters={},s.selectColor=t,s.enable(s.load()),s}},function(e,t){e.exports=require("crypto")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Function=0]="Function",e[e.File=1]="File",e[e.Object=2]="Object",e[e.Normal=3]="Normal"}(t.SymbolType||(t.SymbolType={})),function(e){e[e.Local=0]="Local",e[e.Global=1]="Global",e[e.Neither=2]="Neither",e[e.Both=3]="Both"}(t.SymbolScope||(t.SymbolScope={}))},function(e,t,r){"use strict";var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(n,i){function o(e){try{u(s.next(e))}catch(e){i(e)}}function a(e){try{u(s.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(o,a)}u((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=r(11),i=r(26),o=r(27),a=r(13),u=r(5),c=r(28),l=r(6),d=r(43),h=r(2),p=r(1),f=r(3),m=r(44),g=r(18),b=r(14),v=r(0),y=r(46),C=r(47),S=r(50),x=r(51),E=r(52),R=r(53),w=r(54),O=r(55),T=r(56),I=r(19),P=r(15),F={jlink:y.JLinkServerController,openocd:C.OpenOCDServerController,stutil:S.STUtilServerController,pyocd:x.PyOCDServerController,pe:R.PEServerController,bmp:E.BMPServerController,qemu:w.QEMUServerController,external:O.ExternalServerController};class M{constructor(e,t){this.name=e,this.options=t}}const A=e=>e.startsWith("-")?e.substring(1):`interpreter-exec console "${e}"`;class k extends n.Event{constructor(e,t){super("custom-stop",{reason:e,threadID:t})}}class _ extends n.Event{constructor(e,t=!0){super("custom-continued",{threadID:e,allThreads:t})}}class $ extends n.DebugSession{constructor(e,t=!1,r=1){super(e,t),this.variableHandles=new n.Handles(131072),this.variableHandlesReverse={},this.forceDisassembly=!1,this.activeEditorPath=null,this.currentThreadId=0,this.activeThreadIds=new Set,this.disableSendStoppedEvents=!1,this.stopped=!1,this.stoppedReason="",this.stoppedThreadId=0,this.stoppedEventPending=!1,this.breakpointMap=new Map,this.fileExistsCache=new Map,this.onConfigDone=new v.EventEmitter,this.floatingVariableMap={}}initDebugger(){this.miDebugger.on("launcherror",this.launchError.bind(this)),this.miDebugger.on("quit",this.quitEvent.bind(this)),this.miDebugger.on("exited-normally",this.quitEvent.bind(this)),this.miDebugger.on("stopped",this.stopEvent.bind(this)),this.miDebugger.on("msg",this.handleMsg.bind(this)),this.miDebugger.on("breakpoint",this.handleBreakpoint.bind(this)),this.miDebugger.on("step-end",this.handleBreak.bind(this)),this.miDebugger.on("step-out-end",this.handleBreak.bind(this)),this.miDebugger.on("signal-stop",this.handlePause.bind(this)),this.miDebugger.on("running",this.handleRunning.bind(this)),this.miDebugger.on("thread-created",this.handleThreadCreated.bind(this)),this.miDebugger.on("thread-exited",this.handleThreadExited.bind(this)),this.miDebugger.on("thread-selected",this.handleThreadSelected.bind(this)),this.miDebugger.on("thread-group-exited",this.handleThreadGroupExited.bind(this)),this.sendEvent(new n.InitializedEvent)}initializeRequest(e,t){e.body.supportsHitConditionalBreakpoints=!0,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsConditionalBreakpoints=!0,e.body.supportsFunctionBreakpoints=!0,e.body.supportsEvaluateForHovers=!0,e.body.supportsSetVariable=!0,e.body.supportsRestartRequest=!0,this.sendResponse(e)}launchRequest(e,t){this.args=this.normalizeArguments(t),this.symbolTable=new T.SymbolTable(t.toolchainPath,t.toolchainPrefix,t.executable,t.demangle),this.symbolTable.loadSymbols(),this.breakpointMap=new Map,this.fileExistsCache=new Map,this.processLaunchAttachRequest(e,!1)}attachRequest(e,t){this.args=this.normalizeArguments(t),this.symbolTable=new T.SymbolTable(t.toolchainPath,t.toolchainPrefix,t.executable,t.demangle),this.symbolTable.loadSymbols(),this.breakpointMap=new Map,this.fileExistsCache=new Map,this.processLaunchAttachRequest(e,!0)}normalizeArguments(e){return e.graphConfig=e.graphConfig||[],e.executable&&!p.isAbsolute(e.executable)&&(e.executable=p.normalize(p.join(e.cwd,e.executable))),e.svdFile&&!p.isAbsolute(e.svdFile)&&(e.svdFile=p.normalize(p.join(e.cwd,e.svdFile))),e.swoConfig&&e.swoConfig.decoders&&(e.swoConfig.decoders=e.swoConfig.decoders.map(t=>("advanced"===t.type&&t.decoder&&!p.isAbsolute(t.decoder)&&(t.decoder=p.normalize(p.join(e.cwd,t.decoder))),t))),e}processLaunchAttachRequest(e,t){if(!f.existsSync(this.args.executable))return void this.sendErrorResponse(e,103,`Unable to find executable file at ${this.args.executable}.`);const r=F[this.args.servertype];this.serverController=new r,this.serverController.setArguments(this.args),this.serverController.on("event",this.serverControllerEvent.bind(this)),this.quit=!1,this.attached=!1,this.started=!1,this.crashed=!1,this.debugReady=!1,this.stopped=!1,this.activeThreadIds.clear();const s={min:5e4,max:52e3,retrieve:this.serverController.portsNeeded.length};P.TcpPortScanner.findFreePorts(s,c.GDBServer.LOCALHOST).then(r=>{this.ports={},this.serverController.portsNeeded.forEach((e,t)=>{this.ports[e]=r[t]}),this.serverController.setPorts(this.ports);const s=this.serverController.serverExecutable(),n=this.serverController.serverArguments();let o="win32"!==h.platform()?`${this.args.toolchainPrefix}-gdb`:`${this.args.toolchainPrefix}-gdb.exe`;if(this.args.toolchainPath&&(o=p.normalize(p.join(this.args.toolchainPath,o))),this.args.gdbpath&&(o=this.args.gdbpath),p.isAbsolute(o)){if(!1===f.existsSync(o))return void this.sendErrorResponse(e,103,`${this.serverController.name} GDB executable "${o}" was not found.\n`+'Please configure "cortex-debug.armToolchainPath" correctly.')}else if(!m.sync(o.replace(".exe","")))return void this.sendErrorResponse(e,103,`${this.serverController.name} GDB executable "${o}" was not found.\n`+'Please configure "cortex-debug.armToolchainPath" correctly.');if(s){this.handleMsg("log",`Please check OUTPUT tab (Adapter Output) for output from ${s}`+"\n");const e=`Launching server: "${s}" `+n.map(e=>'"'+e.replace(/"/g,'\\"')+'"').join(" ")+"\n";this.handleMsg("log",e)}let a=this.serverController.initMatch();this.args.overrideGDBServerStartedRegex&&(a=new RegExp(this.args.overrideGDBServerStartedRegex,"i")),this.server=new c.GDBServer(this.args.cwd,s,n,a,this.ports.gdbPort),this.server.on("output",this.handleAdapterOutput.bind(this)),this.server.on("quit",()=>{this.started?this.quitEvent():this.sendErrorResponse(e,103,`${this.serverController.name} GDB Server Quit Unexpectedly. See Adapter Output for more details.`)}),this.server.on("launcherror",t=>{this.sendErrorResponse(e,103,`Failed to launch ${this.serverController.name} GDB Server: ${t.toString()}`)});let l=b.setTimeout(()=>{this.server.exit(),this.sendEvent(new u.TelemetryEvent("Error","Launching Server",`Failed to launch ${this.serverController.name} GDB Server: Timeout.`)),this.sendErrorResponse(e,103,`Failed to launch ${this.serverController.name} GDB Server: Timeout.`)},c.GDBServer.SERVER_TIMEOUT);this.serverController.serverLaunchStarted(),this.server.init().then(r=>{l&&(clearTimeout(l),l=null),this.serverController.serverLaunchCompleted();let s=["-q","--interpreter=mi2"];s=s.concat(this.args.debuggerArgs||[]),this.miDebugger=new i.MI2(o,s),this.initDebugger(),this.miDebugger.printCalls=!!this.args.showDevDebugOutput,this.miDebugger.debugOutput=!!this.args.showDevDebugOutput;const n=[`interpreter-exec console "source ${this.args.extensionPath}/support/gdbsupport.init"`];if(this.args.demangle&&(n.push('interpreter-exec console "set print demangle on"'),n.push('interpreter-exec console "set print asm-demangle on"')),n.push(...this.serverController.initCommands()),t){n.push(...this.args.preAttachCommands.map(A));const e=null!=this.args.overrideAttachCommands?this.args.overrideAttachCommands.map(A):this.serverController.attachCommands();n.push(...e),n.push(...this.args.postAttachCommands.map(A)),n.push(...this.serverController.swoCommands())}else{n.push(...this.args.preLaunchCommands.map(A));const e=null!=this.args.overrideLaunchCommands?this.args.overrideLaunchCommands.map(A):this.serverController.launchCommands();n.push(...e),n.push(...this.args.postLaunchCommands.map(A)),n.push(...this.serverController.swoCommands())}this.serverController.debuggerLaunchStarted(),this.miDebugger.once("debug-ready",()=>{this.debugReady=!0,this.attached=t});{const e=`Launching GDB: "${o}" `+s.map(e=>'"'+e.replace(/"/g,'\\"')+'"').join(" ")+"\n";this.handleMsg("log",e)}this.miDebugger.connect(this.args.cwd,this.args.executable,n).then(()=>{this.started=!0,this.serverController.debuggerLaunchCompleted(),this.sendResponse(e);const t=()=>{b.setTimeout(()=>{this.stopped=!0,this.stoppedReason="start",this.stoppedThreadId=this.currentThreadId,this.sendEvent(new u.StoppedEvent("start",this.currentThreadId,!0)),this.sendEvent(new k("start",this.currentThreadId))},50)};this.args.runToMain?this.miDebugger.sendCommand("break-insert -t --function main").then(()=>{this.miDebugger.once("generic-stopped",t),this.onConfigDone.once("done",()=>{this.miDebugger.sendCommand("exec-continue")})}):(t(),this.onConfigDone.once("done",()=>{this.runPostStartSessionCommands(!1)}))},t=>{this.sendErrorResponse(e,103,`Failed to launch GDB: ${t.toString()}`),this.sendEvent(new u.TelemetryEvent("Error","Launching GDB",t.toString()))})},t=>{l&&(clearTimeout(l),l=null),this.sendEvent(new u.TelemetryEvent("Error","Launching Server",`Failed to launch ${this.serverController.name} GDB Server: ${t.toString()}`)),this.sendErrorResponse(e,103,`Failed to launch ${this.serverController.name} GDB Server: ${t.toString()}`)})},t=>{this.sendEvent(new u.TelemetryEvent("Error","Launching Server",`Failed to find open ports: ${t.toString()}`)),this.sendErrorResponse(e,103,`Failed to find open ports: ${t.toString()}`)})}runPostStartSessionCommands(e,t=10){let r=e?this.args.postRestartSessionCommands:this.args.postStartSessionCommands;if(r&&r.length>0){let e=this.miDebugger.getCurrentToken();r=r.map(A);const s=setInterval(()=>{const t=this.miDebugger.getCurrentToken();e===t?(clearInterval(s),this.miDebugger.postStart(r)):e=t},t)}}customRequest(e,t,r){if(this.serverController.customRequest(e,t,r))this.sendResponse(t);else switch(e){case"set-force-disassembly":t.body={success:!0},this.forceDisassembly=r.force,this.stopped&&(this.activeEditorPath=null,this.sendEvent(new n.ContinuedEvent(this.currentThreadId,!0)),this.sendEvent(new u.StoppedEvent(this.stoppedReason,this.currentThreadId,!0))),this.sendResponse(t);break;case"load-function-symbols":t.body={functionSymbols:this.symbolTable.getFunctionSymbols()},this.sendResponse(t);break;case"set-active-editor":r.path!==this.activeEditorPath&&(this.activeEditorPath=r.path),t.body={},this.sendResponse(t);break;case"get-arguments":t.body=this.args,this.sendResponse(t);break;case"read-memory":this.readMemoryRequestCustom(t,r.address,r.length);break;case"write-memory":this.writeMemoryRequest(t,r.address,r.data);break;case"read-registers":this.readRegistersRequest(t);break;case"read-register-list":this.readRegisterListRequest(t);break;case"disassemble":this.disassembleRequest(t,r);break;case"execute-command":let e=r.command;e=e.startsWith("-")?e.substring(1):`interpreter-exec console "${e}"`,this.miDebugger.sendCommand(e).then(e=>{t.body=e.resultRecords,this.sendResponse(t)},e=>{t.body=e,this.sendErrorResponse(t,110,"Unable to execute command")});break;default:t.body={error:"Invalid command."},this.sendResponse(t)}}disassembleRequest(e,t){return s(this,void 0,void 0,(function*(){if(t.function)try{const r=yield this.getDisassemblyForFunction(t.function,t.file);e.body={instructions:r.instructions,name:r.name,file:r.file,address:r.address,length:r.length},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,1,`Unable to disassemble: ${t.toString()}`)}else if(t.startAddress)try{let r=this.symbolTable.getFunctionAtAddress(t.startAddress);if(r)r=yield this.getDisassemblyForFunction(r.name,r.file),e.body={instructions:r.instructions,name:r.name,file:r.file,address:r.address,length:r.length},this.sendResponse(e);else{const r=yield this.getDisassemblyForAddresses(t.startAddress,t.length||256);e.body={instructions:r},this.sendResponse(e)}}catch(t){this.sendErrorResponse(e,1,`Unable to disassemble: ${t.toString()}`)}else this.sendErrorResponse(e,1,"Unable to disassemble; invalid parameters.")}))}getDisassemblyForFunction(e,t){return s(this,void 0,void 0,(function*(){const r=this.symbolTable.getFunctionByName(e,t);if(!r)throw new Error(`Unable to find function with name ${e}.`);if(r.instructions)return r;const s=r.address,n=r.address+r.length,i=(yield this.miDebugger.sendCommand(`data-disassemble -s ${o.hexFormat(s,8)} -e ${o.hexFormat(n,8)} -- 2`)).result("asm_insns").map(e=>({address:l.MINode.valueOf(e,"address"),functionName:l.MINode.valueOf(e,"func-name"),offset:parseInt(l.MINode.valueOf(e,"offset")),instruction:l.MINode.valueOf(e,"inst"),opcodes:l.MINode.valueOf(e,"opcodes")}));return r.instructions=i,r}))}getDisassemblyForAddresses(e,t){return s(this,void 0,void 0,(function*(){const r=e+t;return(yield this.miDebugger.sendCommand(`data-disassemble -s ${o.hexFormat(e,8)} -e ${o.hexFormat(r,8)} -- 2`)).result("asm_insns").map(e=>({address:l.MINode.valueOf(e,"address"),functionName:l.MINode.valueOf(e,"func-name"),offset:parseInt(l.MINode.valueOf(e,"offset")),instruction:l.MINode.valueOf(e,"inst"),opcodes:l.MINode.valueOf(e,"opcodes")}))}))}readMemoryRequestCustom(e,t,r){this.miDebugger.sendCommand(`data-read-memory-bytes "${t}" ${r}`).then(t=>{const r=t.resultRecords.results[0][1][0][0][1],s=t.resultRecords.results[0][1][0][2][1],n=t.resultRecords.results[0][1][0][3][1].match(/[0-9a-f]{2}/g).map(e=>parseInt(e,16));e.body={startAddress:r,endAddress:s,bytes:n},this.sendResponse(e)},s=>{e.body={error:s},this.sendErrorResponse(e,114,`Unable to read memory: ${s.toString()}`),this.sendEvent(new u.TelemetryEvent("Error","Reading Memory",`${t}-${r.toString(16)}`))})}writeMemoryRequest(e,t,r){const s=o.hexFormat(t,8);this.miDebugger.sendCommand(`data-write-memory-bytes ${s} ${r}`).then(t=>{this.sendResponse(e)},s=>{e.body={error:s},this.sendErrorResponse(e,114,`Unable to write memory: ${s.toString()}`),this.sendEvent(new u.TelemetryEvent("Error","Writing Memory",`${t.toString(16)}-${r.length.toString(16)}`))})}readRegistersRequest(e){const t=this.args.registerUseNaturalFormat?"N":"x";this.miDebugger.sendCommand(`data-list-register-values ${t}`).then(t=>{if("done"===t.resultRecords.resultClass){const r=t.resultRecords.results[0][1];e.body=r.map(e=>{const t={};return e.forEach(e=>{t[e[0]]=e[1]}),t})}else e.body={error:"Unable to parse response"};this.sendResponse(e)},t=>{e.body={error:t},this.sendErrorResponse(e,115,`Unable to read registers: ${t.toString()}`),this.sendEvent(new u.TelemetryEvent("Error","Reading Registers",""))})}readRegisterListRequest(e){this.miDebugger.sendCommand("data-list-register-names").then(t=>{if("done"===t.resultRecords.resultClass){let r;t.resultRecords.results.forEach(e=>{"register-names"===e[0]&&(r=e[1])}),e.body=r}else e.body={error:t.resultRecords.results};this.sendResponse(e)},t=>{e.body={error:t},this.sendErrorResponse(e,116,`Unable to read register list: ${t.toString()}`),this.sendEvent(new u.TelemetryEvent("Error","Reading Register List",""))})}disconnectRequest(e,t){const r=()=>{this.attached?(this.attached=!1,this.miDebugger.detach()):this.miDebugger.stop(),this.commandServer&&(this.commandServer.close(),this.commandServer=void 0),b.setTimeout(()=>{try{this.disableSendStoppedEvents=!1,this.server.exit()}catch(e){}finally{this.sendResponse(e)}},50)};this.disableSendStoppedEvents=!0,this.miDebugger&&(this.attached&&!this.stopped?(this.miDebugger.once("generic-stopped",r),this.miDebugger.sendCommand("exec-interrupt")):r())}restartRequest(e,t){const r=()=>s(this,void 0,void 0,(function*(){this.disableSendStoppedEvents=!1;const t=[];t.push(...this.args.preRestartCommands.map(A));const r=null!=this.args.overrideRestartCommands?this.args.overrideRestartCommands.map(A):this.serverController.restartCommands();t.push(...r),t.push(...this.args.postRestartCommands.map(A)),t.push(...this.serverController.swoCommands()),this.miDebugger.restart(t).then(t=>{this.sendResponse(e),b.setTimeout(()=>{this.stopped=!0,this.stoppedReason="restart",this.sendEvent(new n.ContinuedEvent(this.currentThreadId,!0)),this.sendEvent(new u.StoppedEvent("restart",this.currentThreadId,!0)),this.sendEvent(new k("restart",this.currentThreadId)),this.runPostStartSessionCommands(!0,50)},50)},t=>{this.sendErrorResponse(e,6,`Could not restart: ${t}`)})}));this.disableSendStoppedEvents=!0,this.stopped?r():(this.miDebugger.once("generic-stopped",r),this.miDebugger.sendCommand("exec-interrupt"))}handleAdapterOutput(e){this.sendEvent(new u.AdapterOutputEvent(e,"out"))}serverControllerEvent(e){this.sendEvent(e)}handleMsg(e,t){"target"===e&&(e="stdout"),"log"===e&&(e="stderr"),this.sendEvent(new n.OutputEvent(t,e))}handleRunning(e){this.stopped=!1,this.sendEvent(new n.ContinuedEvent(this.currentThreadId,!0)),this.sendEvent(new _(this.currentThreadId,!0))}findPausedThread(e){if(e.outOfBandRecord&&e.outOfBandRecord[0]&&e.outOfBandRecord[0].output)for(const t of e.outOfBandRecord[0].output)if("thread-id"===t[0])return this.currentThreadId=parseInt(t[1]),void(this.stoppedThreadId=this.currentThreadId)}handleBreakpoint(e){this.stopped=!0,this.stoppedReason="breakpoint",this.findPausedThread(e),this.disableSendStoppedEvents?this.stoppedEventPending=!0:(this.sendEvent(new u.StoppedEvent("breakpoint",this.currentThreadId,!0)),this.sendEvent(new k("breakpoint",this.currentThreadId)))}handleBreak(e){this.stopped=!0,this.stoppedReason="step",this.findPausedThread(e),this.disableSendStoppedEvents?this.stoppedEventPending=!0:(this.sendEvent(new u.StoppedEvent("step",this.currentThreadId,!0)),this.sendEvent(new k("step",this.currentThreadId)))}sendEvent(e){super.sendEvent(e)}handlePause(e){this.stopped=!0,this.stoppedReason="user request",this.findPausedThread(e),this.disableSendStoppedEvents?this.stoppedEventPending=!0:(this.sendEvent(new u.StoppedEvent("user request",this.currentThreadId,!0)),this.sendEvent(new k("user request",this.currentThreadId)))}handleThreadCreated(e){this.activeThreadIds.has(e.threadId)?this.handleMsg("log",`Thread Error: GDB trying to create thread '${e.threadId}' that already exists`):(this.activeThreadIds.add(e.threadId),this.sendEvent(new n.ThreadEvent("started",e.threadId)))}handleThreadExited(e){this.activeThreadIds.has(e.threadId)?this.activeThreadIds.delete(e.threadId):this.handleMsg("log",`Thread Error: GDB trying to delete thread '${e.threadId}' that does not exist.\n`),this.currentThreadId===e.threadId&&(this.currentThreadId=0),this.stoppedThreadId===e.threadId&&(this.stoppedThreadId=0),this.sendEvent(new n.ThreadEvent("exited",e.threadId))}handleThreadSelected(e){this.activeThreadIds.has(e.threadId)?this.currentThreadId=e.threadId:this.handleMsg("log",`Thread Error: GDB trying to select thread '${e.threadId}' that does not exist. No harm done\n`)}handleThreadGroupExited(e){this.currentThreadId=0;for(const e of this.activeThreadIds.values())this.sendEvent(new n.ThreadEvent("exited",e));this.activeThreadIds.clear()}stopEvent(e){this.started||(this.crashed=!0),this.quit||(this.stopped=!0,this.stoppedReason="exception",this.findPausedThread(e),this.sendEvent(new u.StoppedEvent("exception",this.currentThreadId,!0)),this.sendEvent(new k("exception",this.currentThreadId)))}quitEvent(){this.quit=!0,this.sendEvent(new n.TerminatedEvent)}launchError(e){this.handleMsg("stderr","Could not start debugger process, does the program exist in filesystem?\n"),this.handleMsg("stderr",e.toString()+"\n"),this.quitEvent()}static decodeReference(e){return[(65280&e)>>>8,255&e]}static encodeReference(e,t){return 65535&(e<<8|255&t)}setVariableRequest(e,t){return s(this,void 0,void 0,(function*(){try{let r=t.name,s=-1,n=-1;const i=t.variablesReference,o=this.getFloatingVariable(i,r);if(o)r=o.name;else if(i>=131072){const e=this.variableHandles.get(t.variablesReference),s=e.children[r];r=s||`${e.name}.${r}`}else if(i>=256&&i<65535){const e=this.createStackVarName(r,i);this.variableHandlesReverse.hasOwnProperty(e)&&(r=e),[s,n]=$.decodeReference(i)}const a=yield this.miDebugger.varAssign(r,t.value,s,n);e.body={value:a.result("value")},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,11,`Could not set variable: ${t}`)}}))}setFunctionBreakPointsRequest(e,t){const r=r=>s(this,void 0,void 0,(function*(){const s=[];t.breakpoints.forEach(e=>{s.push(this.miDebugger.addBreakPoint({raw:e.name,condition:e.condition,countCondition:e.hitCondition}))});try{const t=yield Promise.all(s),r=[];t.forEach(e=>{e[0]&&r.push({line:e[1].line})}),e.body={breakpoints:r},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,10,t.toString())}r&&(yield this.miDebugger.sendCommand("exec-continue"))})),n=()=>s(this,void 0,void 0,(function*(){this.stopped?yield r(!1):(this.miDebugger.sendCommand("exec-interrupt"),this.miDebugger.once("generic-stopped",()=>{r(!0)}))}));this.debugReady?n():this.miDebugger.once("debug-ready",n)}setBreakPointsRequest(e,t){const r=r=>s(this,void 0,void 0,(function*(){this.debugReady=!0;const s=(this.breakpointMap.get(t.source.path)||[]).map(e=>e.number);try{yield this.miDebugger.removeBreakpoints(s),this.breakpointMap.set(t.source.path,[]);const r=[],n=decodeURIComponent(t.source.path);if(n.startsWith("disassembly:/")){let e=13;n.startsWith("disassembly:///")&&(e=15);const s=n.substring(e,n.length-6).split(":::");let i,o;2===s.length?(i=s[1],o=s[0]):i=s[0];const a=yield this.getDisassemblyForFunction(i,o);a&&t.breakpoints.forEach(e=>{if(e.line<=a.instructions.length){const s=a.instructions[e.line-1];r.push(this.miDebugger.addBreakPoint({file:t.source.path,line:e.line,condition:e.condition,countCondition:e.hitCondition,raw:s.address}))}})}else t.breakpoints.forEach(e=>{r.push(this.miDebugger.addBreakPoint({file:t.source.path,line:e.line,condition:e.condition,countCondition:e.hitCondition}))});const i=(yield Promise.all(r)).filter(e=>null!==e);e.body={breakpoints:i.map(e=>({line:e.line,id:e.number,verified:!0}))},this.breakpointMap.set(t.source.path,i),this.sendResponse(e)}catch(t){this.sendErrorResponse(e,9,t.toString())}r&&(yield this.miDebugger.sendCommand("exec-continue"))})),n=()=>s(this,void 0,void 0,(function*(){this.stopped?yield r(!1):(yield this.miDebugger.sendCommand("exec-interrupt"),this.miDebugger.once("generic-stopped",()=>{r(!0)}))}));this.debugReady?n():this.miDebugger.once("debug-ready",n)}threadsRequest(e){return s(this,void 0,void 0,(function*(){if(!this.stopped||this.disableSendStoppedEvents)return e.body={threads:[]},this.sendResponse(e),Promise.resolve();try{const t=yield this.miDebugger.sendCommand("thread-list-ids"),r=t.result("thread-ids").map(e=>parseInt(e[1])),s=t.result("current-thread-id");if(!r||0===r.length)return e.body={threads:[]},this.sendResponse(e),Promise.resolve();for(const e of r)this.activeThreadIds.has(e)||this.handleThreadCreated({threadId:e,threadGroupId:"i1"});s?this.currentThreadId=parseInt(s):(this.currentThreadId=r.findIndex(e=>e===this.stoppedThreadId)>=0?this.stoppedThreadId:r[0],r.length>1&&(yield this.miDebugger.sendCommand(`thread-select ${this.currentThreadId}`))),(this.stoppedEventPending||this.currentThreadId!==this.stoppedThreadId)&&(this.stoppedEventPending=!1,this.stoppedThreadId=this.currentThreadId,this.sendEvent(new u.StoppedEvent(this.stoppedReason,this.currentThreadId,!0)),this.sendEvent(new k(this.stoppedReason,this.currentThreadId)));const i=(yield Promise.all(r.map(e=>this.miDebugger.sendCommand(`thread-info ${e}`)))).map(e=>{let t=e.result("threads");if(1===t.length){t=t[0];const e=parseInt(l.MINode.valueOf(t,"id")),r=l.MINode.valueOf(t,"target-id"),s=l.MINode.valueOf(t,"details");return new n.Thread(e,s||r)}return null}).filter(e=>null!==e);e.body={threads:i},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,1,`Unable to get thread information: ${t}`)}}))}stackTraceRequest(e,t){return s(this,void 0,void 0,(function*(){try{const r=yield this.miDebugger.getStack(t.threadId,t.startFrame,t.levels),s=[];for(const e of r){const r=$.encodeReference(t.threadId,e.level),i=e.file;let o=this.forceDisassembly||!i;if(o||(o=!(yield this.checkFileExists(i))),!o&&this.activeEditorPath&&this.activeEditorPath.startsWith("disassembly:///")){const t=this.symbolTable.getFunctionByName(e.function,e.fileName);let r;t&&(r=t.file&&t.scope!==I.SymbolScope.Global?`disassembly:///${t.file}:::${t.name}.cdasm`:`disassembly:///${t.name}.cdasm`,r===this.activeEditorPath&&(o=!0))}try{if(o){const t=yield this.getDisassemblyForFunction(e.function,e.fileName);let i=-1;if(t.instructions.forEach((t,r)=>{t.address===e.address&&(i=r+1)}),-1!==i){let o;o=t.file&&t.scope!==I.SymbolScope.Global?`${t.file}:::${t.name}.cdasm`:`${t.name}.cdasm`;const a="disassembly:///"+o;s.push(new n.StackFrame(r,`${e.function}@${e.address}`,new n.Source(o,a),i,0))}else s.push(new n.StackFrame(r,e.function+"@"+e.address,null,e.line,0))}else s.push(new n.StackFrame(r,e.function+"@"+e.address,new n.Source(e.fileName,i),e.line,0))}catch(t){s.push(new n.StackFrame(r,e.function+"@"+e.address,null,e.line,0))}}e.body={stackFrames:s},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,12,`Failed to get Stack Trace: ${t.toString()}`)}}))}configurationDoneRequest(e,t){this.sendResponse(e),this.onConfigDone.emit("done")}scopesRequest(e,t){const r=new Array;r.push(new n.Scope("Local",parseInt(t.frameId),!1)),r.push(new n.Scope("Global",254,!1));const s=65536+parseInt(t.frameId);r.push(new n.Scope("Static",s,!1)),this.floatingVariableMap[s]={},e.body={scopes:r},this.sendResponse(e)}globalVariablesRequest(e,t){return s(this,void 0,void 0,(function*(){const r=this.symbolTable.getGlobalVariables(),s=[];try{for(const e of r){const r=`global_var_${e.name}`;let n;try{(yield this.miDebugger.varUpdate(r,-1,-1)).result("changelist").forEach(e=>{const t=l.MINode.valueOf(e,"name"),r=this.variableHandlesReverse[t];this.variableHandles.get(r).applyChanges(e)});const e=this.variableHandlesReverse[r];n=this.variableHandles.get(e)}catch(t){try{if(!(t instanceof a.MIError&&"Variable object not found"===t.message))throw t;{n=yield this.miDebugger.varCreate(e.name,r);const t=this.findOrCreateVariable(n);n.exp=e.name,n.id=t}}catch(t){this.args.showDevDebugOutput&&(this.handleMsg("stderr",`Could not create global variable ${e.name}\n`),this.handleMsg("stderr",`Error: ${t}\n`)),n=null}}n&&(this.putFloatingVariable(t.variablesReference,e.name,n),s.push(n.toProtocolVariable()))}e.body={variables:s},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,1,`Could not get global variable information: ${t}`)}}))}createStaticVarName(e,t){return`static_var_${t}_${e}`}putFloatingVariable(e,t,r){const s=this.floatingVariableMap[e]||{};s[t]=r,this.floatingVariableMap[e]=s}getFloatingVariable(e,t){const r=this.floatingVariableMap[e];return r?r[t]:null}staticVariablesRequest(e,t,r,n){return s(this,void 0,void 0,(function*(){const s=[];try{const i=(yield this.miDebugger.getFrame(e,t)).fileName,o=this.symbolTable.getStaticVariables(i),u=g.createHash("sha256");u.update(i);const c=u.digest("hex");for(const e of o){const t=this.createStaticVarName(c,e.name);let r;try{(yield this.miDebugger.varUpdate(t,-1,-1)).result("changelist").forEach(e=>{const t=l.MINode.valueOf(e,"name"),r=this.variableHandlesReverse[t];this.variableHandles.get(r).applyChanges(e)});const e=this.variableHandlesReverse[t];r=this.variableHandles.get(e)}catch(s){try{if(!(s instanceof a.MIError&&"Variable object not found"===s.message))throw s;{r=yield this.miDebugger.varCreate(e.name,t);const s=this.findOrCreateVariable(r);r.exp=e.name,r.id=s}}catch(t){this.args.showDevDebugOutput&&(this.handleMsg("stderr",`Could not create static variable ${i}:${e.name}\n`),this.handleMsg("stderr",`Error: ${t}\n`)),r=null}}r&&(this.putFloatingVariable(n.variablesReference,e.name,r),s.push(r.toProtocolVariable()))}r.body={variables:s},this.sendResponse(r)}catch(e){this.sendErrorResponse(r,1,`Could not get static variable information: ${e}`)}}))}createVariable(e,t){return t?this.variableHandles.create(new M(e,t)):this.variableHandles.create(e)}findOrCreateVariable(e){let t;return this.variableHandlesReverse.hasOwnProperty(e.name)?t=this.variableHandlesReverse[e.name]:(t=this.createVariable(e),this.variableHandlesReverse[e.name]=t),e.isCompound()?t:0}createStackVarName(e,t){return`var_${e}_${t}`}stackVariablesRequest(e,t){return s(this,void 0,void 0,(function*(){const[r,s]=$.decodeReference(t.variablesReference),n=[];let i;try{i=yield this.miDebugger.getStackVariables(r,s);for(const e of i)try{const i=this.createStackVarName(e.name,t.variablesReference);let o;try{(yield this.miDebugger.varUpdate(i,r,s)).result("changelist").forEach(e=>{const t=l.MINode.valueOf(e,"name"),r=this.variableHandlesReverse[t];this.variableHandles.get(r).applyChanges(e)});const e=this.variableHandlesReverse[i];o=this.variableHandles.get(e)}catch(t){if(!(t instanceof a.MIError&&"Variable object not found"===t.message))throw t;{o=yield this.miDebugger.varCreate(e.name,i,"*");const t=this.findOrCreateVariable(o);o.exp=e.name,o.id=t}}n.push(o.toProtocolVariable())}catch(t){n.push({name:e.name,value:`<${t}>`,variablesReference:0})}e.body={variables:n},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,1,`Could not expand variable: ${t}`)}}))}variableMembersRequest(e,t,r){return s(this,void 0,void 0,(function*(){let r;try{r=yield this.miDebugger.evalExpression(JSON.stringify(e),-1,-1);try{let s=d.expandValue(this.createVariable.bind(this),r.result("value"),e,r);s?("string"==typeof s[0]&&(s=[{name:"<value>",value:D(s),variablesReference:0}]),t.body={variables:s},this.sendResponse(t)):this.sendErrorResponse(t,2,"Could not expand variable")}catch(e){this.sendErrorResponse(t,2,`Could not expand variable: ${e}`)}}catch(e){this.sendErrorResponse(t,1,`Could not expand variable: ${e}`)}}))}variablesRequest(e,t){return s(this,void 0,void 0,(function*(){let r;if(254===t.variablesReference)return this.globalVariablesRequest(e,t);if(t.variablesReference>=65536&&t.variablesReference<=131071){const[r,s]=$.decodeReference(t.variablesReference);return this.staticVariablesRequest(r,s,e,t)}if(t.variablesReference>=256&&t.variablesReference<65535)return this.stackVariablesRequest(e,t);if(r=this.variableHandles.get(t.variablesReference),"string"==typeof r)return this.variableMembersRequest(r,e,t);if("object"==typeof r)if(r instanceof a.VariableObject){const t=r;let s;const n={};try{s=yield this.miDebugger.varListChildren(r.name,this.args.flattenAnonymous);const i=s.map(e=>{const r=this.findOrCreateVariable(e);if(e.id=r,/^\d+$/.test(e.exp))e.fullExp=`${t.fullExp||t.exp}[${e.exp}]`;else{let r="."+e.exp;if(e.exp.startsWith("<anonymous")){const t=n[e.exp];t&&(n[e.exp]=t+1,e.exp+="#"+t.toString(10)),n[e.exp]=1,r=""}else t.children[e.exp]=e.name;e.fullExp=`${t.fullExp||t.exp}${r}`}return e.toProtocolVariable()});e.body={variables:i},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,1,`Could not expand variable: ${t}`)}}else if(r instanceof M){const t=r;if(t.options.arg){const r=[];let n=!0,i=0;const o=()=>{e.body={variables:r},this.sendResponse(e)},a=()=>s(this,void 0,void 0,(function*(){const s=yield this.miDebugger.evalExpression(JSON.stringify(`${t.name}+${i})`),-1,-1);try{const u=d.expandValue(this.createVariable.bind(this),s.result("value"),t.name,s);if(u)if("string"==typeof u){if("<nullptr>"===u){if(!n)return o();n=!1}else if('"'!==u[0])return r.push({name:"[err]",value:u,variablesReference:0}),o();r.push({name:`[${i++}]`,value:u,variablesReference:0}),a()}else r.push({name:"[err]",value:u,variablesReference:0}),o();else this.sendErrorResponse(e,15,"Could not expand variable")}catch(t){this.sendErrorResponse(e,14,`Could not expand variable: ${t}`)}}));a()}else this.sendErrorResponse(e,13,`Unimplemented variable request options: ${JSON.stringify(t.options)}`)}else e.body={variables:r},this.sendResponse(e);else e.body={variables:[]},this.sendResponse(e)}))}pauseRequest(e,t){this.miDebugger.interrupt().then(t=>{this.sendResponse(e)},t=>{this.sendErrorResponse(e,3,`Could not pause: ${t}`)})}continueRequest(e,t){this.miDebugger.continue(t.threadId).then(t=>{e.body={allThreadsContinued:!0},this.sendResponse(e)},t=>{this.sendErrorResponse(e,2,`Could not continue: ${t}`)})}stepInRequest(e,t){return s(this,void 0,void 0,(function*(){try{let r=this.forceDisassembly;if(!r){const e=yield this.miDebugger.getFrame(t.threadId,0);if(r=!(yield this.checkFileExists(e.file)),this.activeEditorPath&&this.activeEditorPath.startsWith("disassembly:///")){const t=this.symbolTable.getFunctionByName(e.function,e.fileName);let s;s=t.file&&t.scope!==I.SymbolScope.Global?`disassembly:///${t.file}:::${t.name}.cdasm`:`disassembly:///${t.name}.cdasm`,s===this.activeEditorPath&&(r=!0)}}yield this.miDebugger.step(t.threadId,r);this.sendResponse(e)}catch(t){this.sendErrorResponse(e,6,`Could not step over: ${t}`)}}))}stepOutRequest(e,t){this.miDebugger.stepOut(t.threadId).then(t=>{this.sendResponse(e)},t=>{this.sendErrorResponse(e,5,`Could not step out: ${t}`)})}nextRequest(e,t){return s(this,void 0,void 0,(function*(){try{let r=this.forceDisassembly;if(!r){const e=yield this.miDebugger.getFrame(t.threadId,0);if(r=!(yield this.checkFileExists(e.file)),this.activeEditorPath&&this.activeEditorPath.startsWith("disassembly:///")){const t=this.symbolTable.getFunctionByName(e.function,e.fileName);let s;s=t.file&&t.scope!==I.SymbolScope.Global?`disassembly:///${t.file}:::${t.name}.cdasm`:`disassembly:///${t.name}.cdasm`,s===this.activeEditorPath&&(r=!0)}}yield this.miDebugger.next(t.threadId,r);this.sendResponse(e)}catch(t){this.sendErrorResponse(e,6,`Could not step over: ${t}`)}}))}checkFileExists(e){return e?this.fileExistsCache.has(e)?Promise.resolve(this.fileExistsCache.get(e)):new Promise((t,r)=>{f.exists(e,r=>{this.fileExistsCache.set(e,r),t(r)})}):Promise.resolve(!1)}evaluateRequest(e,t){return s(this,void 0,void 0,(function*(){const r=(e,t)=>t?this.variableHandles.create(new M(e,t)):this.variableHandles.create(e),s=e=>{let t;return this.variableHandlesReverse.hasOwnProperty(e.name)?t=this.variableHandlesReverse[e.name]:(t=r(e),this.variableHandlesReverse[e.name]=t),e.isCompound()?t:0};let n=this.currentThreadId,i=0;if(t.frameId?[n,i]=$.decodeReference(t.frameId):this.handleMsg("log",`Thread Warning: ${t.context}: eval. expression '${t.expression}' with no thread context. Using default\n`),"watch"===t.context)try{const r=t.expression,o=g.createHash("sha256");o.update(r);const u=`watch_${o.digest("hex")}`;let c;try{(yield this.miDebugger.varUpdate(u,n,i)).result("changelist").forEach(e=>{const t=l.MINode.valueOf(e,"name"),r=this.variableHandlesReverse[t];this.variableHandles.get(r).applyChanges(e)});const t=this.variableHandlesReverse[u];c=this.variableHandles.get(t),e.body={result:c.value,variablesReference:c.id}}catch(t){if(!(t instanceof a.MIError&&"Variable object not found"===t.message))throw t;{c=yield this.miDebugger.varCreate(r,u,"@");const t=s(c);c.exp=r,c.id=t,e.body={result:c.value,variablesReference:c.id}}}this.sendResponse(e)}catch(t){e.body={result:`<${t.toString()}>`,variablesReference:0},this.sendErrorResponse(e,7,t.toString())}else if("hover"===t.context)try{const r=yield this.miDebugger.evalExpression(t.expression,n,i);e.body={variablesReference:0,result:r.result("value")},this.sendResponse(e)}catch(t){this.sendErrorResponse(e,7,t.toString())}else this.miDebugger.sendCommand(`thread-select ${n}`),this.miDebugger.sendCommand(`stack-select-frame ${i}`),this.miDebugger.sendUserInput(t.expression).then(t=>{e.body=void 0===t?{result:"",variablesReference:0}:{result:JSON.stringify(t),variablesReference:0},this.sendResponse(e)},t=>{this.sendErrorResponse(e,8,t.toString())})}))}}function D(e){return"object"==typeof e?void 0!==e.length?e.join(", "):JSON.stringify(e):e}t.GDBDebugSession=$,n.DebugSession.run($)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),n=r(9);class i extends s.EventEmitter{constructor(){super(),this._pendingRequests=new Map}start(e,t){this._sequence=1,this._writableStream=t,this._rawData=new Buffer(0),e.on("data",e=>this._handleData(e)),e.on("close",()=>{this._emitEvent(new n.Event("close"))}),e.on("error",e=>{this._emitEvent(new n.Event("error","inStream error: "+(e&&e.message)))}),t.on("error",e=>{this._emitEvent(new n.Event("error","outStream error: "+(e&&e.message)))}),e.resume()}stop(){this._writableStream&&this._writableStream.end()}sendEvent(e){this._send("event",e)}sendResponse(e){e.seq>0?console.error(`attempt to send more than one response for command ${e.command}`):this._send("response",e)}sendRequest(e,t,r,s){const i={command:e};if(t&&Object.keys(t).length>0&&(i.arguments=t),this._writableStream){if(this._send("request",i),s){this._pendingRequests.set(i.seq,s);const e=setTimeout(()=>{clearTimeout(e);const t=this._pendingRequests.get(i.seq);t&&(this._pendingRequests.delete(i.seq),t(new n.Response(i,"timeout")))},r)}}else this._emitEvent(new n.Event("error","sendRequest: No writableStream"))}dispatchRequest(e){}_emitEvent(e){this.emit(e.event,e)}_send(e,t){if(t.type=e,t.seq=this._sequence++,this._writableStream){const e=JSON.stringify(t);this._writableStream.write(`Content-Length: ${Buffer.byteLength(e,"utf8")}\r\n\r\n${e}`,"utf8")}}_handleData(e){for(this._rawData=Buffer.concat([this._rawData,e]);;){if(this._contentLength>=0){if(this._rawData.length>=this._contentLength){const e=this._rawData.toString("utf8",0,this._contentLength);if(this._rawData=this._rawData.slice(this._contentLength),this._contentLength=-1,e.length>0)try{let t=JSON.parse(e);if("request"===t.type)this.dispatchRequest(t);else if("response"===t.type){const e=t,r=this._pendingRequests.get(e.request_seq);r&&(this._pendingRequests.delete(e.request_seq),r(e))}}catch(e){this._emitEvent(new n.Event("error","Error handling data: "+(e&&e.message)))}continue}}else{const e=this._rawData.indexOf(i.TWO_CRLF);if(-1!==e){const t=this._rawData.toString("utf8",0,e).split("\r\n");for(let e=0;e<t.length;e++){const r=t[e].split(/: +/);"Content-Length"==r[0]&&(this._contentLength=+r[1])}this._rawData=this._rawData.slice(e+i.TWO_CRLF.length);continue}}break}}}i.TWO_CRLF="\r\n\r\n",t.ProtocolServer=i},function(e,t){e.exports=require("url")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(12),n=s.logger,i=r(8);class o extends i.DebugSession{constructor(e,t,r){super(t,r),this.obsolete_logFilePath=e,this.on("error",e=>{n.error(e.body)})}start(e,t){super.start(e,t),n.init(e=>this.sendEvent(e),this.obsolete_logFilePath,this._isServer)}sendEvent(e){e instanceof s.LogOutputEvent||n.verbose(`To client: ${JSON.stringify(e)}`),super.sendEvent(e)}sendRequest(e,t,r,s){n.verbose(`To client: ${JSON.stringify(e)}(${JSON.stringify(t)}), timeout: ${r}`),super.sendRequest(e,t,r,s)}sendResponse(e){n.verbose(`To client: ${JSON.stringify(e)}`),super.sendResponse(e)}dispatchRequest(e){n.verbose(`From client: ${e.command}(${JSON.stringify(e.arguments)})`),super.dispatchRequest(e)}}t.LoggingDebugSession=o},function(e,t,r){var s=r(1),n=r(3),i=parseInt("0777",8);function o(e,t,r,a){"function"==typeof t?(r=t,t={}):t&&"object"==typeof t||(t={mode:t});var u=t.mode,c=t.fs||n;void 0===u&&(u=i),a||(a=null);var l=r||function(){};e=s.resolve(e),c.mkdir(e,u,(function(r){if(!r)return l(null,a=a||e);switch(r.code){case"ENOENT":if(s.dirname(e)===e)return l(r);o(s.dirname(e),t,(function(r,s){r?l(r,s):o(e,t,l,s)}));break;default:c.stat(e,(function(e,t){e||!t.isDirectory()?l(r,a):l(null,a)}))}}))}e.exports=o.mkdirp=o.mkdirP=o,o.sync=function e(t,r,o){r&&"object"==typeof r||(r={mode:r});var a=r.mode,u=r.fs||n;void 0===a&&(a=i),o||(o=null),t=s.resolve(t);try{u.mkdirSync(t,a),o=o||t}catch(n){switch(n.code){case"ENOENT":o=e(s.dirname(t),r,o),e(t,r,o);break;default:var c;try{c=u.statSync(t)}catch(e){throw n}if(!c.isDirectory())throw n}}return o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Handles=class{constructor(e){this.START_HANDLE=1e3,this._handleMap=new Map,this._nextHandle="number"==typeof e?e:this.START_HANDLE}reset(){this._nextHandle=this.START_HANDLE,this._handleMap=new Map}create(e){var t=this._nextHandle++;return this._handleMap.set(t,e),t}get(e,t){return this._handleMap.get(e)||t}}},function(e,t,r){"use strict";var s=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))((function(n,i){function o(e){try{u(s.next(e))}catch(e){i(e)}}function a(e){try{u(s.throw(e))}catch(e){i(e)}}function u(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(o,a)}u((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=r(13),i=r(4),o=r(0),a=r(6),u=r(1),c=r(1);u.posix;function l(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}t.escape=l;const d=/^(?:\d*|undefined)[\*\+\=]|[\~\@\&\^]/,h=/(?:\d*|undefined)\(gdb\)/,p=/\d+/;function f(e){return!d.exec(e)}class m extends o.EventEmitter{constructor(e,t){super(),this.application=e,this.args=t,this.currentToken=1,this.handlers={}}connect(e,t,r){return c.isAbsolute(t)||(t=c.join(e,t)),new Promise((s,n)=>{const o=[...this.args,t];this.process=i.spawn(this.application,o,{cwd:e,env:this.procEnv}),this.process.stdout.on("data",this.stdout.bind(this)),this.process.stderr.on("data",this.stderr.bind(this)),this.process.on("exit",(()=>{this.emit("quit")}).bind(this)),this.process.on("error",(e=>{this.emit("launcherror",e)}).bind(this));const a=this.sendCommand("gdb-set target-async on",!0),u=r.map(e=>this.sendCommand(e));u.push(a),Promise.all(u).then(()=>{this.emit("debug-ready"),s()},n)})}stdout(e){this.buffer+="string"==typeof e?e:e.toString("utf8");const t=this.buffer.lastIndexOf("\n");-1!==t&&(this.onOutput(this.buffer.substr(0,t)),this.buffer=this.buffer.substr(t+1)),this.buffer.length&&this.onOutputPartial(this.buffer)&&(this.buffer="")}stderr(e){this.errbuf+="string"==typeof e?e:e.toString("utf8");const t=this.errbuf.lastIndexOf("\n");-1!==t&&(this.onOutputStderr(this.errbuf.substr(0,t)),this.errbuf=this.errbuf.substr(t+1)),this.errbuf.length&&(this.logNoNewLine("stderr",this.errbuf),this.errbuf="")}onOutputStderr(e){(e=e.split("\n")).forEach(e=>{this.log("stderr",e)})}onOutputPartial(e){return!!f(e)&&(this.logNoNewLine("stdout",e),!0)}onOutput(e){(e=e.split("\n")).forEach(e=>{if(f(e))h.exec(e)||this.log("stdout",e);else{const t=a.parseMI(e);this.debugOutput&&this.log("log","GDB -> App: "+JSON.stringify(t));let r=!1;void 0!==t.token&&this.handlers[t.token]&&(this.handlers[t.token](t),delete this.handlers[t.token],r=!0),!r&&t.resultRecords&&"error"===t.resultRecords.resultClass&&this.log("stderr",t.result("msg")||e),t.outOfBandRecord&&(t.outOfBandRecord.forEach(e=>{if(e.isStream)this.log(e.type,e.content);else if("exec"===e.type)if(this.emit("exec-async-output",t),"running"===e.asyncClass)this.emit("running",t);else if("stopped"===e.asyncClass){const e=t.record("reason");0,"breakpoint-hit"===e?this.emit("breakpoint",t):"end-stepping-range"===e?this.emit("step-end",t):"function-finished"===e?this.emit("step-out-end",t):"signal-received"===e?this.emit("signal-stop",t):"exited-normally"===e?this.emit("exited-normally",t):"exited"===e?(this.log("stderr","Program exited with code "+t.record("exit-code")),this.emit("exited-normally",t)):(this.log("console","Not implemented stop reason (assuming exception): "+e),this.emit("stopped",t)),this.emit("generic-stopped",t)}else this.log("log",JSON.stringify(t));else if("notify"===e.type){let t,r;for(const s of e.output)"id"===s[0]?t=s[1]:"group-id"===s[0]&&(r=s[1]);"thread-created"===e.asyncClass?this.emit("thread-created",{threadId:parseInt(t),threadGroupId:r}):"thread-exited"===e.asyncClass?this.emit("thread-exited",{threadId:parseInt(t),threadGroupId:r}):"thread-selected"===e.asyncClass?this.emit("thread-selected",{threadId:parseInt(t)}):"thread-group-exited"===e.asyncClass&&this.emit("thread-group-exited",{threadGroupId:t})}}),r=!0),void 0===t.token&&void 0===t.resultRecords&&0===t.outOfBandRecord.length&&(r=!0),r||this.log("log","Unhandled: "+JSON.stringify(t))}})}tryKill(){const e=this.process;try{process.kill(-e.pid)}catch(t){this.log("log",`kill failed for ${-e.pid}`+t)}}stop(){return s(this,void 0,void 0,(function*(){this.process;const e=setTimeout(()=>{this.tryKill()},1e3);this.process.on("exit",t=>{clearTimeout(e)}),yield this.sendCommand("target-disconnect"),this.sendRaw("-gdb-exit")}))}detach(){return s(this,void 0,void 0,(function*(){yield this.sendCommand("target-detach"),this.stop()}))}interrupt(e=""){return new Promise((t,r)=>{this.sendCommand(`exec-interrupt ${e}`).then(e=>{t("done"===e.resultRecords.resultClass)},r)})}continue(e){return new Promise((t,r)=>{this.sendCommand(`exec-continue --thread ${e}`).then(e=>{t("running"===e.resultRecords.resultClass)},r)})}next(e,t){return new Promise((r,s)=>{const n=t?"exec-next-instruction":"exec-next";this.sendCommand(`${n} --thread ${e}`).then(e=>{r("running"===e.resultRecords.resultClass)},s)})}step(e,t){return new Promise((r,s)=>{const n=t?"exec-step-instruction":"exec-step";this.sendCommand(`${n} --thread ${e}`).then(e=>{r("running"===e.resultRecords.resultClass)},s)})}stepOut(e){return new Promise((t,r)=>{this.sendCommand(`exec-finish --thread ${e}`).then(e=>{t("running"===e.resultRecords.resultClass)},r)})}restart(e){return this._sendCommandSequence(e)}postStart(e){return this._sendCommandSequence(e)}_sendCommandSequence(e){return new Promise((t,r)=>{const s=(e=>{if(0===e.length)t(!0);else{const t=e[0];this.sendCommand(t).then(t=>{s(e.slice(1))},r)}}).bind(this);s(e)})}changeVariable(e,t){return this.sendCommand("gdb-set var "+e+"="+t)}setBreakPointCondition(e,t){return this.sendCommand("break-condition "+e+" "+t)}addBreakPoint(e){return new Promise((t,r)=>{let s="";if(e.countCondition)if(">"===e.countCondition[0])s+="-i "+p.exec(e.countCondition.substr(1))[0]+" ";else{const t=p.exec(e.countCondition)[0];t.length!==e.countCondition.length?(this.log("stderr","Unsupported break count expression: '"+e.countCondition+"'. Only supports 'X' for breaking once after X times or '>X' for ignoring the first X breaks"),s+="-t "):0!==parseInt(t)&&(s+="-t -i "+parseInt(t)+" ")}e.raw?s+="*"+l(e.raw):s+='"'+l(e.file)+":"+e.line+'"',this.sendCommand(`break-insert ${s}`).then(s=>{if("done"===s.resultRecords.resultClass){const n=parseInt(s.result("bkpt.number"));e.number=n,e.condition?this.setBreakPointCondition(n,e.condition).then(r=>{"done"===r.resultRecords.resultClass?t(e):t(null)},r):t(e)}else t(null)},r)})}removeBreakpoints(e){return new Promise((t,r)=>{if(0===e.length)t(!0);else{const s="break-delete "+e.join(" ");this.sendCommand(s).then(e=>{t("done"===e.resultRecords.resultClass)},r)}})}getFrame(e,t){return new Promise((r,s)=>{const n=`stack-info-frame --thread ${e} --frame ${t}`;this.sendCommand(n).then(e=>{const t=e.result("frame"),s=a.MINode.valueOf(t,"level"),n=a.MINode.valueOf(t,"addr"),i=a.MINode.valueOf(t,"func"),o=a.MINode.valueOf(t,"file"),u=a.MINode.valueOf(t,"fullname");let c=0;const l=a.MINode.valueOf(t,"line");l&&(c=parseInt(l)),r({address:n,fileName:o,file:u,function:i,level:s,line:c})},s)})}getStack(e,t,r){return new Promise((s,n)=>{this.sendCommand(`stack-list-frames --thread ${e} ${t} ${r}`).then(e=>{const t=e.result("stack"),r=[];t.forEach(e=>{const t=a.MINode.valueOf(e,"@frame.level"),s=a.MINode.valueOf(e,"@frame.addr"),n=a.MINode.valueOf(e,"@frame.func"),i=a.MINode.valueOf(e,"@frame.file"),o=a.MINode.valueOf(e,"@frame.fullname");let u=0;const c=a.MINode.valueOf(e,"@frame.line");c&&(u=parseInt(c));const l=parseInt(a.MINode.valueOf(e,"@frame.from"));r.push({address:s,fileName:i,file:o,function:n||l,level:t,line:u})}),s(r)},n)})}getStackVariables(e,t){return s(this,void 0,void 0,(function*(){const r=(yield this.sendCommand(`stack-list-variables --thread ${e} --frame ${t} --simple-values`)).result("variables"),s=[];for(const e of r){const t=a.MINode.valueOf(e,"name"),r=a.MINode.valueOf(e,"value"),n=a.MINode.valueOf(e,"type");s.push({name:t,valueStr:r,type:n,raw:e})}return s}))}examineMemory(e,t){return new Promise((r,s)=>{this.sendCommand("data-read-memory-bytes 0x"+e.toString(16)+" "+t).then(e=>{r(e.result("memory[0].contents"))},s)})}evalExpression(e,t,r){return new Promise((s,n)=>{const i=m.getThreadFrameStr(t,r);this.sendCommand(`data-evaluate-expression ${i} `+e).then(e=>{s(e)},n)})}varCreate(e,t="-",r="@"){return s(this,void 0,void 0,(function*(){let s=null;e=e.trim(),/,[bdhonx]$/i.test(e)&&(s=e.substring(e.length-1).toLocaleLowerCase(),e=e.substring(0,e.length-2)),e=e.replace(/"/g,'\\"');const i=yield this.sendCommand(`var-create ${t} ${r} "${e}"`);let o=null;if(s&&"-"!==t){const e=yield this.sendCommand(`var-set-format ${t} ${m.FORMAT_SPEC_MAP[s]}`);o=e.result("value")}let a=i.result("");return o&&(a=a.map(e=>"value"===e[0]?["value",o]:e)),new n.VariableObject(a)}))}varEvalExpression(e){return s(this,void 0,void 0,(function*(){return this.sendCommand(`var-evaluate-expression ${e}`)}))}varListChildren(e,t){return s(this,void 0,void 0,(function*(){const r=(yield this.sendCommand(`var-list-children --all-values ${e}`)).result("children")||[],s=[];for(const e of r){const r=new n.VariableObject(e[1]);t&&r.exp.startsWith("<anonymous ")?s.push(...yield this.varListChildren(r.name,t)):s.push(r)}return s}))}static getThreadFrameStr(e,t){return(e>0?`--thread ${e} `:"")+(t>=0?`--frame ${t}`:"")}varUpdate(e="*",t,r){return s(this,void 0,void 0,(function*(){return this.sendCommand(`var-update ${m.getThreadFrameStr(t,r)} --all-values ${e}`)}))}varAssign(e,t,r,n){return s(this,void 0,void 0,(function*(){return this.sendCommand(`var-assign ${m.getThreadFrameStr(r,n)} ${e} ${t}`)}))}logNoNewLine(e,t){this.emit("msg",e,t)}log(e,t){this.emit("msg",e,"\n"===t[t.length-1]?t:t+"\n")}sendUserInput(e){return e.startsWith("-")?this.sendCommand(e.substr(1)):this.sendCommand(`interpreter-exec console "${e}"`)}sendRaw(e){this.printCalls&&this.log("log",e),e.includes("undefined")&&console.log(e),this.process.stdin.write(e+"\n")}getCurrentToken(){return this.currentToken}sendCommand(e,t=!1){const r=this.currentToken++;return new Promise((s,i)=>{this.handlers[r]=r=>{r&&r.resultRecords&&"error"===r.resultRecords.resultClass?t?(this.log("stderr",`WARNING: Error executing command '${e}'`),s(r)):i(new n.MIError(r.result("msg")||"Internal error",e)):s(r)},this.sendRaw(r+"-"+e)})}isReady(){return!!this.process}}m.FORMAT_SPEC_MAP={b:"binary",d:"decimal",h:"hexadecimal",o:"octal",n:"natural",x:"hexadecimal"},t.MI2=m},function(e,t,r){"use strict";function s(e,t){let r=0;const s=e+t-1;for(let t=e;t<=s;t++)r=(r|1<<t)>>>0;return r}function n(e){return/^0b([01]+)$/i.test(e)?parseInt(e.substring(2),2):/^0x([0-9a-f]+)$/i.test(e)?parseInt(e.substring(2),16):/^[0-9]+/i.test(e)?parseInt(e,10):/^#[0-1]+/i.test(e)?parseInt(e.substring(1),2):void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.hexFormat=function(e,t=8,r=!0){let s=e.toString(16);for(;s.length<t;)s="0"+s;return r?"0x"+s:s},t.binaryFormat=function(e,t=0,r=!0,s=!1){let n=(e>>>0).toString(2);for(;n.length<t;)n="0"+n;if(s){const e=4-n.length%4;for(let t=0;t<e;t++)n="0"+n;const t=n.match(/[01]{4}/g);n=t.join(" "),n=n.substring(e)}return r?"0b"+n:n},t.createMask=s,t.extractBits=function(e,t,r){return(e&s(t,r))>>>t>>>0},t.parseInteger=n,t.parseDimIndex=function(e,t){if(-1!==e.indexOf(",")){const r=e.split(",").map(e=>e.trim());if(r.length!==t)throw new Error("dimIndex Element has invalid specification.");return r}if(/^([0-9]+)\-([0-9]+)$/i.test(e)){const r=e.split("-").map(e=>n(e)),s=r[0];if(r[1]-s+1<t)throw new Error("dimIndex Element has invalid specification.");const i=[];for(let e=0;e<t;e++)i.push(`${s+e}`);return i}if(/^[a-zA-Z]\-[a-zA-Z]$/.test(e)){const r=e.charCodeAt(0);if(e.charCodeAt(2)-r+1<t)throw new Error("dimIndex Element has invalid specification.");const s=[];for(let e=0;e<t;e++)s.push(String.fromCharCode(r+e));return s}return[]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4),n=r(2),i=r(0),o=r(14),a=r(15);class u extends i.EventEmitter{constructor(e,t,r,s,n){super(),this.cwd=e,this.application=t,this.args=r,this.initMatch=s,this.port=n,this.outBuffer="",this.errBuffer=""}init(){return new Promise((e,t)=>{null!==this.application?(this.initResolve=e,this.initReject=t,this.process=s.spawn(this.application,this.args,{cwd:this.cwd}),this.process.stdout.on("data",this.onStdout.bind(this)),this.process.stderr.on("data",this.onStderr.bind(this)),this.process.on("exit",this.onExit.bind(this)),this.process.on("error",this.onError.bind(this)),"number"==typeof this.port&&this.port>0&&a.TcpPortScanner.waitForPortOpen(this.port,u.LOCALHOST,!0,50,u.SERVER_TIMEOUT-1e3).then(()=>{this.initResolve&&(this.initResolve(!0),this.initReject=null,this.initResolve=null)}).catch(e=>{}),-1!==this.application.indexOf("st-util")&&"win32"===n.platform()&&o.setTimeout(()=>{this.initResolve&&(this.initResolve(!0),this.initReject=null,this.initResolve=null)},500),null==this.initMatch&&o.setTimeout(()=>{this.initResolve&&(this.initResolve(!0),this.initReject=null,this.initResolve=null)},1e3)):e()})}exit(){this.process&&(this.process.kill(),this.process=null)}onExit(e,t){this.emit("exit",e,t)}onError(e){this.initReject&&(this.initReject(e),this.initReject=null,this.initResolve=null),this.emit("launcherror",e)}onStdout(e){this.outBuffer+="string"==typeof e?e:e.toString("utf8"),this.initResolve&&this.initMatch.test(this.outBuffer)&&(this.initResolve(!0),this.initResolve=null,this.initReject=null);const t=this.outBuffer.lastIndexOf("\n");-1!==t&&(this.emit("output",this.outBuffer.substring(0,t)),this.outBuffer=this.outBuffer.substring(t+1))}onStderr(e){this.errBuffer+="string"==typeof e?e:e.toString("utf8"),this.initResolve&&this.initMatch.test(this.errBuffer)&&(this.initResolve(!0),this.initResolve=null,this.initReject=null);const t=this.errBuffer.lastIndexOf("\n");-1!==t&&(this.emit("output",this.errBuffer.substring(0,t)),this.errBuffer=this.errBuffer.substring(t+1))}}u.SERVER_TIMEOUT=1e4,u.LOCALHOST="0.0.0.0",t.GDBServer=u},function(e,t,r){"use strict";t.check=c,t.waitUntilFreeOnHost=function(e,t,r,n){var i;s.obj(e)?(i=e).inUse=!1:i=u(e,t,!1,r,n);return l(i)},t.waitUntilFree=function(e,t,r){var n;s.obj(e)?((n=e).host="127.0.0.1",n.inUse=!1):n=u(e,"127.0.0.1",!1,t,r);return l(n)},t.waitUntilUsedOnHost=d,t.waitUntilUsed=function(e,t,r){var n;s.obj(e)?((n=e).host="127.0.0.1",n.inUse=!0):n=u(e,"127.0.0.1",!0,t,r);return d(n)},t.waitForStatus=l;var s=r(30),n=r(10),i=r(16),o=r(35)("tcp-port-used");function a(){var e,t,r=new Promise((function(r,s){e=r,t=s}));return{resolve:e,reject:t,promise:r}}function u(e,t,r,s,n){var i={};return i.port=e,i.host=t,i.inUse=r,i.retryTimeMs=s,i.timeOutMs=n,i}function c(e,t){var r,c,l=a(),d=!0;if(c=s.obj(e)?e:u(e,t),!s.port(c.port))return o("Error invalid port: "+i.inspect(c.port)),l.reject(new Error("invalid port: "+i.inspect(c.port))),l.promise;function h(){r&&(r.removeAllListeners("connect"),r.removeAllListeners("error"),r.end(),r.destroy(),r.unref())}return s.nullOrUndefined(c.host)&&(o("set host address to default 127.0.0.1"),c.host="127.0.0.1"),(r=new n.Socket).once("connect",(function(){l.resolve(d),h()})),r.once("error",(function(e){"ECONNREFUSED"!==e.code?l.reject(e):(d=!1,l.resolve(d)),h()})),r.connect({port:c.port,host:c.host},(function(){})),l.promise}function l(e,t,r,n,i){var l,d,h,p=a(),f=!1;if(h=s.obj(e)?e:u(e,t,r,n,i),!s.bool(h.inUse))return p.reject(new Error("inUse must be a boolean")),p.promise;function m(){l&&clearTimeout(l),d&&clearTimeout(d)}return s.positiveInt(h.retryTimeMs)||(h.retryTimeMs=250,o("set retryTime to default 250ms")),s.positiveInt(h.timeOutMs)||(h.timeOutMs=2e3,o("set timeOutMs to default 2000ms")),l=setTimeout((function(){f=!0,m(),p.reject(new Error("timeout"))}),h.timeOutMs),function e(){c(h.port,h.host).then((function(t){if(!f)return t===h.inUse?(p.resolve(),void m()):void(d=setTimeout((function(){e()}),h.retryTimeMs))}),(function(e){f||(p.reject(e),m())}))}(),p.promise}function d(e,t,r,n){var i;return s.obj(e)?(i=e).inUse=!0:i=u(e,t,!0,r,n),l(i)}},function(e,t,r){"use strict";const s={}.hasOwnProperty,n={}.toString,i=t,o=r(31),a=r(32);i.version=r(33).version,i.browser=function(){return!i.node()&&"undefined"!=typeof window&&"[object global]"===n.call(window)},i.defined=function(e){return void 0!==e},i.def=i.defined,i.nodejs=function(){return process&&process.hasOwnProperty("version")&&process.hasOwnProperty("versions")},i.node=i.nodejs,i.undefined=function(e){return void 0===e},i.udef=i.undef=i.undefined,i.array=function(e){return"[object Array]"===n.call(e)},i.arr=i.ary=i.arry=i.array,i.arrayLike=function(e){return!i.nullOrUndef(e)&&(void 0!==e&&s.call(e,"length")&&isFinite(e.length))},i.arrLike=i.arryLike=i.aryLike=i.arraylike=i.arrayLike,i.arguments=function(e){return"[object Arguments]"===n.call(e)},i.args=i.arguments,i.boolean=function(e){return"[object Boolean]"===n.call(e)},i.bool=i.boolean,i.buffer=function(e){return i.nodejs()&&Buffer&&Buffer.hasOwnProperty("isBuffer")&&Buffer.isBuffer(e)},i.buff=i.buf=i.buffer,i.date=function(e){return"[object Date]"===n.call(e)},i.error=function(e){return"[object Error]"===n.call(e)},i.err=i.error,i.false=function(e){return!1===e},i.function=function(e){return i.syncFunction(e)||i.asyncFunction(e)},i.fun=i.func=i.function,i.asyncFunction=function(e){return"[object AsyncFunction]"===n.call(e)},i.asyncFun=i.asyncFunc=i.asyncFunction,i.syncFunction=function(e){return"[object Function]"===n.call(e)},i.syncFun=i.syncFunc=i.syncFunction,i.null=function(e){return null===e},i.nullOrUndefined=function(e){return null==e},i.nullOrUndef=i.nullOrUndefined,i.number=function(e){return"[object Number]"===n.call(e)},i.num=i.number,i.object=function(e){return"[object Object]"===n.call(e)},i.obj=i.object,i.regExp=function(e){return"[object RegExp]"===n.call(e)},i.re=i.regexp=i.regExp,i.string=function(e){return"[object String]"===n.call(e)},i.str=i.string,i.true=function(e){return!0===e};var u=new RegExp("[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}","i");i.uuid=function(e){return u.test(e)},i.equal=function(e,t){var r=n.call(e);return typeof e==typeof t&&(r===n.call(t)&&("[object Object]"===r||"[object Array]"===r?o(e,t):"[object Function]"===r?e.prototype===t.prototype:"[object Date]"===r?e.getTime()===t.getTime():e===t))},i.objEquals=i.eq=i.equal;var c={boolean:1,number:1,string:1,undefined:1};i.hosted=function(e,t){if(i.nullOrUndef(e))return!1;var r=typeof t[e];return"object"===r?!!t[e]:!c[r]},i.instanceOf=function(e,t){return!i.nullOrUndef(e)&&!i.nullOrUndef(t)&&e instanceof t},i.instOf=i.instanceof=i.instanceOf,i.objectInstanceOf=function(e,t){try{return"[object Object]"===n.call(e)&&e instanceof t}catch(e){return!1}},i.instOf=i.instanceOf=i.objInstOf=i.objectInstanceOf,i.type=function(e,t){return typeof e===t},i.a=i.type,i.empty=function(e){var t=n.call(e);if("[object Array]"===t||"[object Arguments]"===t)return 0===e.length;if("[object Object]"===t){for(var r in e)if(s.call(e,r))return!1;return!0}return"[object String]"===t&&""===e},i.emptyArguments=function(e){return"[object Arguments]"===n.call(e)&&0===e.length},i.noArgs=i.emptyArgs=i.emptyArguments,i.emptyArray=function(e){return"[object Array]"===n.call(e)&&0===e.length},i.emptyArry=i.emptyAry=i.emptyArray,i.emptyArrayLike=function(e){return 0===e.length},i.emptyArrLike=i.emptyArrayLike,i.emptyString=function(e){return i.string(e)&&0===e.length},i.emptyStr=i.emptyString,i.nonEmptyArray=function(e){return"[object Array]"===n.call(e)&&e.length>0},i.nonEmptyArr=i.nonEmptyArry=i.nonEmptyAry=i.nonEmptyArray,i.nonEmptyObject=function(e){return"[object Object]"===n.call(e)&&Object.keys(e).length>0},i.nonEmptyObj=i.nonEmptyObject,i.emptyObject=function(e){return"[object Object]"===n.call(e)&&0===Object.keys(e).length},i.emptyObj=i.emptyObject,i.nonEmptyString=function(e){return i.string(e)&&e.length>0},i.nonEmptyStr=i.nonEmptyString,i.even=function(e){return"[object Number]"===n.call(e)&&e%2==0},i.decimal=function(e){return"[object Number]"===n.call(e)&&e%1!=0},i.dec=i.decNum=i.decimal,i.integer=function(e){return"[object Number]"===n.call(e)&&e%1==0},i.int=i.integer,i.notANumber=function(e){return!i.num(e)||e!=e},i.nan=i.notANum=i.notANumber,i.odd=function(e){return!i.decimal(e)&&"[object Number]"===n.call(e)&&e%2!=0},i.oddNumber=i.oddNum=i.odd,i.positiveNumber=function(e){return"[object Number]"===n.call(e)&&e>0},i.pos=i.positive=i.posNum=i.positiveNum=i.positiveNumber,i.negativeNumber=function(e){return"[object Number]"===n.call(e)&&e<0},i.neg=i.negNum=i.negativeNum=i.negativeNumber,i.negativeInteger=function(e){return"[object Number]"===n.call(e)&&e%1==0&&e<0},i.negativeInt=i.negInt=i.negativeInteger,i.positiveInteger=function(e){return"[object Number]"===n.call(e)&&e%1==0&&e>0},i.posInt=i.positiveInt=i.positiveInteger,i.divisibleBy=function(e,t){return 0!==e&&("[object Number]"===n.call(e)&&0!==t&&e%t==0)},i.divBy=i.divisBy=i.divisibleBy,i.greaterOrEqualTo=function(e,t){return e>=t},i.greaterOrEqual=i.ge=i.greaterOrEqualTo,i.greaterThan=function(e,t){return e>t},i.gt=i.greaterThan,i.lessThanOrEqualTo=function(e,t){return e<=t},i.lessThanOrEq=i.lessThanOrEqual=i.le=i.lessThanOrEqualTo,i.lessThan=function(e,t){return e<t},i.lt=i.lessThan,i.maximum=function(e,t){if(!i.arrayLike(t)||!i.number(e))return!1;for(var r=t.length;--r>-1;)if(e<t[r])return!1;return!0},i.max=i.maximum,i.minimum=function(e,t){if(!i.arrayLike(t)||!i.number(e))return!1;for(var r=t.length;--r>-1;)if(e>t[r])return!1;return!0},i.min=i.minimum,i.within=function(e,t,r){return e>=t&&e<=r},i.withIn=i.within,i.prettyClose=function(e,t,r){return!(!i.number(e)||!i.number(t))&&(!(i.defined(r)&&!i.posInt(r))&&(i.undefined(r)&&(r=2),e.toFixed(r)===t.toFixed(r)))},i.closish=i.near=i.prettyClose,i.dnsAddress=function(e){return!!i.nonEmptyStr(e)&&(!(e.length>255)&&(!d.test(e)&&!!l.test(e)))},i.dnsAddr=i.dns=i.dnsAddress;var l=/^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])(\.([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]{0,61}[a-zA-Z0-9]))*$/,d=/^([0-9]|[0-9][0-9\-]{0,61}[0-9])(\.([0-9]|[0-9][0-9\-]{0,61}[0-9]))*$/;i.emailAddress=function(e){return!!i.nonEmptyStr(e)&&h.test(e)},i.email=i.emailAddr=i.emailAddress;var h=/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*$/;i.ipv4Address=function(e){if(!i.nonEmptyStr(e))return!1;if(e.length>15)return!1;var t=e.split(".");if(!i.array(t)||4!==t.length)return!1;for(var r=0;r<t.length;r++){var s=parseInt(t[r],10);if(isNaN(s))return!1;if(s<0||s>255)return!1}return!0},i.ipv4=i.ipv4Addr=i.ipv4Address,i.ipv6Address=function(e){return!!i.nonEmptyStr(e)&&a.v6({extract:!0}).test(e)},i.ipv6=i.ipv6Addr=i.ipv6Address,i.ipAddress=function(e){return!!i.nonEmptyStr(e)&&(i.ipv4Address(e)||i.ipv6Address(e))},i.ip=i.ipAddr=i.ipAddress,i.hostAddress=function(e){return!!i.nonEmptyStr(e)&&(i.dns(e)||i.ipv4(e)||i.ipv6(e))},i.host=i.hostIp=i.hostAddr=i.hostAddress,i.port=function(e){return!(!i.num(e)||i.negativeInt(e)||e>65535)},i.systemPort=function(e){return!!(i.port(e)&&e<1024)},i.sysPort=i.systemPort,i.userPort=function(e){return!!(i.port(e)&&e>1023)},i.creditCardNumber=function(e){if(!i.str(e))return!1;var t,r,s=e.split("");for(t=s.length-1,r=1;t>-1;t--,r++)r%2==0&&(s[t]*=2);e=s.join("");var n=0;for(t=0;t<e.length;t++)n+=Math.floor(e[t]);return n%10==0},i.creditCard=i.creditCardNum=i.creditCardNumber,i.americanExpressCardNumber=function(e){if(!i.str(e)||15!==e.length)return!1;var t=Math.floor(e.slice(0,2));return(34===t||37===t)&&!!i.creditCardNumber(e)},i.amexCard=i.amexCardNum=i.americanExpressCardNumber,i.chinaUnionPayCardNumber=function(e){if(!i.str(e)||e.length<16&&e.length>19)return!1;var t=Math.floor(e.slice(0,2));return 62===t||88===t},i.chinaUnion=i.chinaUnionPayCard=i.chinaUnionPayCardNumber,i.dinersClubCarteBlancheCardNumber=function(e){if(!i.str(e)||14!==e.length)return!1;var t=Math.floor(e.slice(0,3));return!(t<300||t>305)&&!!i.creditCardNumber(e)},i.dinersClubCB=i.dinersClubCarteBlancheCard=i.dinersClubCarteBlancheCardNumber,i.dinersClubInternationalCardNumber=function(e){if(!i.str(e)||14!==e.length)return!1;var t=Math.floor(e.slice(0,3)),r=Math.floor(e.slice(0,2));return(!(t<300||t>305)||309===t||36===r||!(r<38||r>39))&&!!i.creditCardNumber(e)},i.dinersClubInt=i.dinersClubInternationalCard=i.dinersClubInternationalCardNumber,i.dinersClubUSACanadaCardNumber=function(e){if(!i.str(e)||16!==e.length)return!1;var t=Math.floor(e.slice(0,2));return(54===t||55===t)&&!!i.creditCardNumber(e)},i.dinersClub=i.dinersClubUSACanCard=i.dinersClubUSACanadaCardNumber,i.discoverCardNumber=function(e){if(!i.str(e)||16!==e.length)return!1;var t=Math.floor(e.slice(0,6)),r=Math.floor(e.slice(0,3));return("6011"===e.slice(0,4)||!(t<622126||t>622925)||!(r<644||r>649)||"65"===e.slice(0,2))&&!!i.creditCardNumber(e)},i.discover=i.discoverCard=i.discoverCardNumber,i.instaPaymentCardNumber=function(e){if(!i.str(e)||16!==e.length)return!1;var t=Math.floor(e.slice(0,3));return!(t<637||t>639)&&!!i.creditCardNumber(e)},i.instaPayment=i.instaPaymentCardNumber,i.jcbCardNumber=function(e){if(!i.str(e)||16!==e.length)return!1;var t=Math.floor(e.slice(0,4));return!(t<3528||t>3589)&&!!i.creditCardNumber(e)},i.jcb=i.jcbCard=i.jcbCardNumber,i.laserCardNumber=function(e){if(!i.str(e)||e.length<16&&e.length>19)return!1;var t=Math.floor(e.slice(0,4));return-1!==[6304,6706,6771,6709].indexOf(t)&&!!i.creditCardNumber(e)},i.laser=i.laserCard=i.laserCardNumber,i.maestroCardNumber=function(e){if(!i.str(e)||e.length<12||e.length>19)return!1;var t=e.slice(0,4);return-1!==["5018","5020","5038","5612","5893","6304","6759","6761","6762","6763","0604","6390"].indexOf(t)&&!!i.creditCardNumber(e)},i.maestro=i.maestroCard=i.maestroCardNumber,i.dankortCardNumber=function(e){return!(!i.str(e)||16!==e.length)&&("5019"===e.slice(0,4)&&!!i.creditCardNumber(e))},i.dankort=i.dankortCard=i.dankortCardNumber,i.masterCardCardNumber=function(e){if(!i.str(e)||16!==e.length)return!1;var t=Math.floor(e.slice(0,2));return!(t<50||t>55)&&!!i.creditCardNumber(e)},i.masterCard=i.masterCardCard=i.masterCardCardNumber,i.visaCardNumber=function(e){return!(!i.str(e)||13!==e.length&&16!==e.length)&&("4"===e.slice(0,1)&&!!i.creditCardNumber(e))},i.visa=i.visaCard=i.visaCardNumber,i.visaElectronCardNumber=function(e){if(!i.str(e)||16!==e.length)return!1;var t=Math.floor(e.slice(0,4));return"417500"!==e.slice(0,6)&&-1===[4026,4405,4508,4844,4913,4917].indexOf(t)||i.creditCardNumber(e),!1},i.visaElectron=i.visaElectronCard=i.visaElectronCardNumber;var p=/^[0-9a-fA-F]{24}$/;i.mongoId=i.objectId=i.objId=function(e){return Boolean(e)&&!Array.isArray(e)&&p.test(String(e))},i.matching=i.match=i.inArgs=function(e){if(arguments.length<2)return!1;for(var t=!1,r=1;r<arguments.length;r++){var s=i.equal(e,arguments[r]);t=t||s}return t},i.streetAddress=function(e){if(!i.str(e))return!1;return/\b\d+[\s](?:[A-Za-z0-9.-]+[\s]+)+\b(ALLEY|ALY|AVENUE|AVE|BEND|BND|BLUFFS?|BLFS?|BOULEVARD|BLVD|BRANCH|BR|CENTERS?|CTRS?|CIRCLES?|CIRS?|CLIFFS?|CLFS?|COURTS?|CTS?|COVES?|CVS?|CREEK|CRK|CRESCENT|CRES|CREST|CRST|CROSSING|XING|DRIVES?|DRS?|EXPRESSWAY|EXPY|FREEWAY|FWY|HEIGHTS|HTS|HIGHWAY|HWY|HILLS?|HLS?|LANE|LN|LOOP|MANORS?|MNRS?|MOTORWAY|MTWY|MOUNT|MT|PARKS?|PARKWAYS?|PKWY|PASS|PLACE|PL|PLAZA|PLZ|POINTS?|PTS?|RIDGES?|RDGS?|ROADS?|RDS?|ROUTE|RTE?|SHOALS?|SHLS?|SHORES?|SHRS?|SPRINGS?|SPGS?|SPURS?|STREETS?|STS?|SUMMIT|SMT|TERRACE|TER|THROUGHWAY|TRWY|TRAFFICWAY|TRFY|TRAIL|TRL|TURNPIKE|TPKE|VALLEYS?|VLYS?|WAYS?)+(?:[\.\-\s\,]?)*((APARTMENT|APT|APPT|#|NUMBER|NUM|FLOOR|FL|\s)?(\d)*)\b/gi.test(e)},i.street=i.address=i.streetAddress,i.zipCode=function(e){if(i.undefined(e)||!i.string(e)&&!i.number(e))return!1;return/^\d{5}(?:-\d{4})?$/.test(e)},i.zip=i.zipCode,i.phoneNumber=function(e){if(!i.string(e))return!1;return/(?:(?:\+?1\s*(?:[.-]\s*)?)?(?:(\(?)(?:(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]‌​)\s*)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\)?)\s*(?:[.-]\s*)?)?([2-9]1[02-‌​9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})/g.test(e)},i.phone=i.phoneNumber;var f=r(34);i.url=function(e){return f(e)},i.uri=i.url,i.enumerator=function(e,t){var r=!1;if(!i.defined(e)||!i.defined(t)||!i.arrayLike(t))return r;for(var s=0,n=t.length;s<n;s++)if(i.equal(e,t[s])){r=!0;break}return r},i.enum=i.inArray=i.enumerator},function(e,t){var r=Array.prototype.slice,s="function"==typeof Object.keys?Object.keys:function(e){var t=[];for(var r in e)t.push(r);return t},n=e.exports=function(e,t){return 0===e&&0===t?1/e==1/t:e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():a(e)?a(t):"object"!=typeof e&&"object"!=typeof t?e==t:function(e,t){if(i(e)||i(t))return!1;if(e.prototype!==t.prototype)return!1;if(o(e))return!!o(t)&&(e=r.call(e),t=r.call(t),n(e,t));try{var a,u,c=s(e),l=s(t)}catch(e){return!1}if(c.length!=l.length)return!1;for(c.sort(),l.sort(),u=c.length-1;u>=0;u--)if(c[u]!=l[u])return!1;for(u=c.length-1;u>=0;u--)if(a=c[u],!n(e[a],t[a]))return!1;return!0}(e,t))};function i(e){return null==e}function o(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function a(e){return"number"==typeof e&&e!=e}},function(e,t,r){"use strict";const s="(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}",n="[0-9a-fA-F]{1,4}",i=`\n(\n(?:${n}:){7}(?:${n}|:)|                                // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${n}:){6}(?:${s}|:${n}|:)|                         // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${n}:){5}(?::${s}|(:${n}){1,2}|:)|                 // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${n}:){4}(?:(:${n}){0,1}:${s}|(:${n}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${n}:){3}(?:(:${n}){0,2}:${s}|(:${n}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${n}:){2}(?:(:${n}){0,3}:${s}|(:${n}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${n}:){1}(?:(:${n}){0,4}:${s}|(:${n}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::((?::${n}){0,5}:${s}|(?::${n}){1,7}|:))           // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(%[0-9a-zA-Z]{1,})?                                           // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),o=e.exports=e=>e&&e.exact?new RegExp(`(?:^${s}$)|(?:^${i}$)`):new RegExp(`(?:${s})|(?:${i})`,"g");o.v4=e=>e&&e.exact?new RegExp(`^${s}$`):new RegExp(s,"g"),o.v6=e=>e&&e.exact?new RegExp(`^${i}$`):new RegExp(i,"g")},function(e){e.exports={_args:[["is2@2.0.1","c:\\users\\jordan.jordanspc\\desktop\\fyp\\cortex-debug-master\\cortex-debug-master"]],_from:"is2@2.0.1",_id:"is2@2.0.1",_inBundle:!1,_integrity:"sha512-+WaJvnaA7aJySz2q/8sLjMb2Mw14KTplHmSwcSpZ/fWJPkUmqw3YTzSWbPJ7OAwRvdYTWF2Wg+yYJ1AdP5Z8CA==",_location:"/is2",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"is2@2.0.1",name:"is2",escapedName:"is2",rawSpec:"2.0.1",saveSpec:null,fetchSpec:"2.0.1"},_requiredBy:["/tcp-port-used"],_resolved:"https://registry.npmjs.org/is2/-/is2-2.0.1.tgz",_spec:"2.0.1",_where:"c:\\users\\jordan.jordanspc\\desktop\\fyp\\cortex-debug-master\\cortex-debug-master",author:{name:"Enrico Marino",email:"enrico.marino@email.com"},bugs:{url:"http://github.com/stdarg/is/issues"},dependencies:{"deep-is":"^0.1.3","ip-regex":"^2.1.0","is-url":"^1.2.2"},description:"A type checking library where each exported function returns either true or false and does not throw. Also added tests.",devDependencies:{jsdom:"0.5.0",mocha:"5.0.1",mongodb:"3.0.2"},engines:{node:">=v0.10.0"},homepage:"http://github.com/stdarg/is2",keywords:["type","check","checker","checking","utilities","network","networking","credit","card","validation"],license:"MIT",main:"./index.js",maintainers:"Edmond Meinfelder <edmond@stdarg.com>, Chris Oyler <christopher.oyler@gmail.com>",name:"is2",repository:{type:"git",url:"git+ssh://git@github.com/stdarg/is2.git"},scripts:{test:"mocha -C --reporter list tests.js"},tags:["type","check","checker","checking","utilities","network","networking","credit","card","validation"],version:"2.0.1"}},function(e,t){e.exports=function(e){if("string"!=typeof e)return!1;var t=e.match(r);if(!t)return!1;var i=t[1];if(!i)return!1;if(s.test(i)||n.test(i))return!0;return!1};var r=/^(?:\w+:)?\/\/(\S+)$/,s=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,n=/^[^\s\.]+\.\S{2,}$/},function(e,t,r){"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(36):e.exports=r(38)},function(e,t,r){t.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let s=0,n=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(s++,"%c"===e&&(n=s))}),t.splice(n,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=r(17)(t);const{formatters:s}=e.exports;s.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},function(e,t){var r=1e3,s=6e4,n=36e5,i=24*n;function o(e,t,r,s){var n=t>=1.5*r;return Math.round(e/r)+" "+s+(n?"s":"")}e.exports=function(e,t){t=t||{};var a=typeof e;if("string"===a&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*i;case"hours":case"hour":case"hrs":case"hr":case"h":return o*n;case"minutes":case"minute":case"mins":case"min":case"m":return o*s;case"seconds":case"second":case"secs":case"sec":case"s":return o*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===a&&!1===isNaN(e))return t.long?function(e){var t=Math.abs(e);if(t>=i)return o(e,t,i,"day");if(t>=n)return o(e,t,n,"hour");if(t>=s)return o(e,t,s,"minute");if(t>=r)return o(e,t,r,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=i)return Math.round(e/i)+"d";if(t>=n)return Math.round(e/n)+"h";if(t>=s)return Math.round(e/s)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){const s=r(39),n=r(16);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let s=0;s<r.length;s++)e.inspectOpts[r[s]]=t.inspectOpts[r[s]]},t.log=function(...e){return process.stderr.write(n.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:s,useColors:n}=this;if(n){const t=this.color,n="[3"+(t<8?t:"8;5;"+t),i=`  ${n};1m${s} [0m`;r[0]=i+r[0].split("\n").join("\n"+i),r.push(n+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+s+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):s.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{const e=r(40);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(e,t)=>t.toUpperCase());let s=process.env[t];return s=!!/^(yes|on|true|enabled)$/i.test(s)||!/^(no|off|false|disabled)$/i.test(s)&&("null"===s?null:Number(s)),e[r]=s,e},{}),e.exports=r(17)(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts).replace(/\s*\n\s*/g," ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts)}},function(e,t){e.exports=require("tty")},function(e,t,r){"use strict";const s=r(2),n=r(41),i=process.env;let o;function a(e){return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(function(e){if(!1===o)return 0;if(n("color=16m")||n("color=full")||n("color=truecolor"))return 3;if(n("color=256"))return 2;if(e&&!e.isTTY&&!0!==o)return 0;const t=o?1:0;if("win32"===process.platform){const e=s.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in i)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(e=>e in i)||"codeship"===i.CI_NAME?1:t;if("TEAMCITY_VERSION"in i)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(i.TEAMCITY_VERSION)?1:0;if("truecolor"===i.COLORTERM)return 3;if("TERM_PROGRAM"in i){const e=parseInt((i.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(i.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(i.TERM)?2:/^screen|^xterm|^vt100|^rxvt|color|ansi|cygwin|linux/i.test(i.TERM)||"COLORTERM"in i?1:(i.TERM,t)}(e))}n("no-color")||n("no-colors")||n("color=false")?o=!1:(n("color")||n("colors")||n("color=true")||n("color=always"))&&(o=!0),"FORCE_COLOR"in i&&(o=0===i.FORCE_COLOR.length||0!==parseInt(i.FORCE_COLOR,10)),e.exports={supportsColor:a,stdout:a(process.stdout),stderr:a(process.stderr)}},function(e,t,r){"use strict";e.exports=(e,t)=>{t=t||process.argv;const r=e.startsWith("-")?"":1===e.length?"-":"--",s=t.indexOf(r+e),n=t.indexOf("--");return-1!==s&&(-1===n||s<n)}},function(e,t,r){"use strict";var s=r(4).exec,n=r(4).execSync,i=r(3),o=r(1),a=i.access,u=i.accessSync,c=i.constants||i,l="win32"==process.platform,d=function(e,t,r){!function(e,t){a(e,c.F_OK,(function(e){t(!e)}))}(e,(function(n){if(n)!function(e,t){a(e,c.F_OK|c.X_OK,(function(e){t(null,!e)}))}(e,r);else s("command -v "+t+" 2>/dev/null && { echo >&1 "+t+"; exit 0; }",(function(e,t,s){r(null,!!t)}))}))},h=function(e,t){if(function(e){try{return u(e,c.F_OK),!1}catch(e){return!0}}(e))try{return!!n("command -v "+t+" 2>/dev/null && { echo >&1 "+t+"; exit 0; }")}catch(e){return!1}return function(e){try{return u(e,c.F_OK|c.X_OK),!0}catch(e){return!1}}(e)},p=function(e){return/[^A-Za-z0-9_\/:=-]/.test(e)&&(e=(e="'"+e.replace(/'/g,"'\\''")+"'").replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")),e};l&&(p=function(e){return/[\\]/.test(e)?'"'+o.dirname(e)+'"'+":"+('"'+o.basename(e)+'"'):'"'+e+'"'}),e.exports=function e(t,r){var n=p(t);if(!r&&"undefined"!=typeof Promise)return new Promise((function(r,s){e(t,(function(e,n){n?r(t):s(e)}))}));l?function(e,t,r){if(/[\x00-\x1f<>:"\|\?\*]/.test(e))r(null,!1);else s("where "+t,(function(e){r(null,null===e)}))}(t,n,r):d(t,n,r)},e.exports.sync=function(e){var t=p(e);return l?function(e,t,r){if(/[\x00-\x1f<>:"\|\?\*]/.test(e))return!1;try{return!!n("where "+t,{stdio:[]})}catch(e){return!1}}(e,t):h(e,t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(6),n=/^([a-zA-Z_\-][a-zA-Z0-9_\-]*|\[\d+\])\s*=\s*/,i=/^[a-zA-Z_\-][a-zA-Z0-9_\-]*/,o=/^\<.+?\>/,a=/^(0x[0-9a-fA-F]+\s*)"/,u=/^0x[0-9a-fA-F]+/,c=/^0x0+\b/,l=/^(\d+) ['"]/,d=/^\d+(\.\d+)?/;t.isExpandable=function(e){let t;return 0===(e=e.trim()).length?0:e.startsWith("{...}")?2:"{"===e[0]?1:e.startsWith("true")||e.startsWith("false")||(t=c.exec(e))||(t=a.exec(e))?0:(t=u.exec(e))?2:((t=l.exec(e))||(t=d.exec(e))||(t=i.exec(e))||(t=o.exec(e)),0)},t.expandValue=function(e,t,r="",h){const p=()=>{if('"'!==(t=t.trim())[0]&&"'"!==t[0])return"";let e=1,r=!0;const s=t[0];let n=t.substr(1),i=!1;for(;r;)i?i=!1:"\\"===n[0]?i=!0:n[0]===s&&(r=!1),n=n.substr(1),e++;const o=t.substr(0,e).trim();return t=t.substr(e).trim(),o},f=[r];let m,g,b,v,y,C="";const S=e=>{let t="",r="";return f.push(e),f.forEach(e=>{if(r="",""!==e)if(e.startsWith("["))t+=e;else if(t){for(;e.startsWith("*");)r+="*",e=e.substr(1);t=t+"."+e}else t=e}),f.pop(),r+t};return m=()=>'"'===(t=t.trim())[0]?p():"{"===t[0]?(()=>{if("{"!==(t=t.trim())[0])return;if("}"===(t=t.substr(1).trim())[0])return t=t.substr(1).trim(),[];if(t.startsWith("...")&&"}"===(t=t.substr(3).trim())[0])return t=t.substr(1).trim(),"<...>";const e=t.indexOf("="),r=t.indexOf("{"),s=t.indexOf(",");let n=r;if(-1!==s&&s<r&&(n=s),-1!==n&&e>n||-1===e){const e=[];f.push("[0]");let r=m();f.pop(),e.push(y("[0]",r));let s=0;for(;;){if(f.push("["+ ++s+"]"),!(r=b())){f.pop();break}f.pop(),e.push(y("["+s+"]",r))}return t=t.substr(1).trim(),e}let i=v(!0);if(i){const e=[];for(e.push(i);i=g(!0);)e.push(i);return t=t.substr(1).trim(),e}})():(()=>{let e,r;return 0===(t=t.trim()).length?e=void 0:t.startsWith("true")?(e="true",t=t.substr(4).trim()):t.startsWith("false")?(e="false",t=t.substr(5).trim()):(r=c.exec(t))?(e="<nullptr>",t=t.substr(r[0].length).trim()):(r=a.exec(t))?(t=t.substr(r[1].length).trim(),e=p()):(r=u.exec(t))?(e="*"+r[0],t=t.substr(r[0].length).trim()):(r=l.exec(t))?(e=r[1],t=t.substr(r[0].length-1),e+=" "+p()):(r=d.exec(t))||(r=i.exec(t))||(r=o.exec(t))?(e=r[0],t=t.substr(r[0].length).trim()):e=t,e})(),v=(e=!1)=>{t=t.trim();const r=n.exec(t);if(!r)return;t=t.substr(r[0].length).trim();const s=C=r[1];e&&f.push(C);const i=m();return e&&f.pop(),y(s,i)},y=(t,r)=>{let n=0;return"object"==typeof r&&(n=e(r),r="Object"),"string"==typeof r&&r.startsWith("*0x")&&(h&&"1"===s.MINode.valueOf(h,"arg")?(n=e(S("*("+t),{arg:!0}),r="<args>"):(n=e(S("*"+t)),r="Object@"+r)),"string"==typeof r&&r.startsWith("<...>")&&(n=e(S(t)),r="..."),{name:t,value:r,variablesReference:n}},b=()=>{if(","===(t=t.trim())[0])return t=t.substr(1).trim(),m()},g=(e=!1)=>{if(","===(t=t.trim())[0])return t=t.substr(1).trim(),v(e)},t=t.trim(),m()}},function(e,t,r){"use strict";var s=r(45),n=r(3),i=r(1);function o(e,t){s.some(a(e),u,t)}function a(e){var t=process.env.PATH||"",r=process.env.PATHEXT||"";return t.replace(/["]+/g,"").split(i.delimiter).map((function(t){return r.split(i.delimiter).map((function(r){return i.join(t,e+r)}))})).reduce((function(e,t){return e.concat(t)}))}function u(e,t){n.stat(e,(function(e,r){if(e)return t(!1);t(r.isFile())}))}function c(e){try{return n.statSync(e).isFile()}catch(e){return!1}}e.exports=o,o.async=o,o.sync=function(e){return a(e).some(c)},o.all=function(e,t){s.every(e,o.async,t)},o.all.sync=function(e){return e.every(o.sync)},o.some=function(e,t){s.some(e,o.async,t)},o.some.sync=function(e){return e.some(o.sync)},o.first=function(e,t){s.detect(e,o.async,(function(e){t(e||!1)}))},o.first.sync=function(e){var t=e.filter(o.sync);return!!t.length&&t[0]},o.every=o.all,o.any=o.some},function(e,t,r){var s;
/*!
 * async
 * https://github.com/caolan/async
 *
 * Copyright 2010-2014 Caolan McMahon
 * Released under the MIT license
 */!function(){var r,n={};function i(){}function o(e){return e}function a(e){return!!e}function u(e){return!e}var c="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this;function l(e){return function(){if(null===e)throw new Error("Callback was already called.");e.apply(this,arguments),e=null}}function d(e){return function(){null!==e&&(e.apply(this,arguments),e=null)}}null!=c&&(r=c.async),n.noConflict=function(){return c.async=r,n};var h=Object.prototype.toString,p=Array.isArray||function(e){return"[object Array]"===h.call(e)};function f(e){return p(e)||"number"==typeof e.length&&e.length>=0&&e.length%1==0}function m(e,t){for(var r=-1,s=e.length;++r<s;)t(e[r],r,e)}function g(e,t){for(var r=-1,s=e.length,n=Array(s);++r<s;)n[r]=t(e[r],r,e);return n}function b(e){return g(Array(e),(function(e,t){return t}))}function v(e,t,r){return m(e,(function(e,s,n){r=t(r,e,s,n)})),r}function y(e,t){m(S(e),(function(r){t(e[r],r)}))}function C(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1}var S=Object.keys||function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t};function x(e){var t,r,s=-1;return f(e)?(t=e.length,function(){return++s<t?s:null}):(r=S(e),t=r.length,function(){return++s<t?r[s]:null})}function E(e,t){return t=null==t?e.length-1:+t,function(){for(var r=Math.max(arguments.length-t,0),s=Array(r),n=0;n<r;n++)s[n]=arguments[n+t];switch(t){case 0:return e.call(this,s);case 1:return e.call(this,arguments[0],s)}}}function R(e){return function(t,r,s){return e(t,s)}}var w="function"==typeof setImmediate&&setImmediate,O=w?function(e){w(e)}:function(e){setTimeout(e,0)};function T(e){return function(t,r,s){s=d(s||i);var n=x(t=t||[]);if(e<=0)return s(null);var o=!1,a=0,u=!1;!function i(){if(o&&a<=0)return s(null);for(;a<e&&!u;){var c=n();if(null===c)return o=!0,void(a<=0&&s(null));a+=1,r(t[c],c,l((function(e){a-=1,e?(s(e),u=!0):i()})))}}()}}function I(e){return function(t,r,s){return e(n.eachOf,t,r,s)}}function P(e){return function(t,r,s,n){return e(T(r),t,s,n)}}function F(e){return function(t,r,s){return e(n.eachOfSeries,t,r,s)}}function M(e,t,r,s){s=d(s||i);var n=f(t=t||[])?[]:{};e(t,(function(e,t,s){r(e,(function(e,r){n[t]=r,s(e)}))}),(function(e){s(e,n)}))}function A(e,t,r,s){var n=[];e(t,(function(e,t,s){r(e,(function(r){r&&n.push({index:t,value:e}),s()}))}),(function(){s(g(n.sort((function(e,t){return e.index-t.index})),(function(e){return e.value})))}))}function k(e,t,r,s){A(e,t,(function(e,t){r(e,(function(e){t(!e)}))}),s)}function _(e,t,r){return function(s,n,i,o){function a(){o&&o(r(!1,void 0))}function u(e,s,n){if(!o)return n();i(e,(function(s){o&&t(s)&&(o(r(!0,e)),o=i=!1),n()}))}arguments.length>3?e(s,n,u,a):(o=i,i=n,e(s,u,a))}}function $(e,t){return t}function D(e,t,r){r=r||i;var s=f(t)?[]:{};e(t,(function(e,t,r){e(E((function(e,n){n.length<=1&&(n=n[0]),s[t]=n,r(e)})))}),(function(e){r(e,s)}))}function N(e,t,r,s){var n=[];e(t,(function(e,t,s){r(e,(function(e,t){n=n.concat(t||[]),s(e)}))}),(function(e){s(e,n)}))}function L(e,t,r){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");function s(e,t,r,s){if(null!=s&&"function"!=typeof s)throw new Error("task callback must be a function");if(e.started=!0,p(t)||(t=[t]),0===t.length&&e.idle())return n.setImmediate((function(){e.drain()}));m(t,(function(t){var n={data:t,callback:s||i};r?e.tasks.unshift(n):e.tasks.push(n),e.tasks.length===e.concurrency&&e.saturated()})),n.setImmediate(e.process)}function o(e,t){return function(){a-=1;var r=!1,s=arguments;m(t,(function(e){m(u,(function(t,s){t!==e||r||(u.splice(s,1),r=!0)})),e.callback.apply(e,s)})),e.tasks.length+a===0&&e.drain(),e.process()}}var a=0,u=[],c={tasks:[],concurrency:t,payload:r,saturated:i,empty:i,drain:i,started:!1,paused:!1,push:function(e,t){s(c,e,!1,t)},kill:function(){c.drain=i,c.tasks=[]},unshift:function(e,t){s(c,e,!0,t)},process:function(){for(;!c.paused&&a<c.concurrency&&c.tasks.length;){var t=c.payload?c.tasks.splice(0,c.payload):c.tasks.splice(0,c.tasks.length),r=g(t,(function(e){return e.data}));0===c.tasks.length&&c.empty(),a+=1,u.push(t[0]);var s=l(o(c,t));e(r,s)}},length:function(){return c.tasks.length},running:function(){return a},workersList:function(){return u},idle:function(){return c.tasks.length+a===0},pause:function(){c.paused=!0},resume:function(){if(!1!==c.paused){c.paused=!1;for(var e=Math.min(c.concurrency,c.tasks.length),t=1;t<=e;t++)n.setImmediate(c.process)}}};return c}function q(e){return E((function(t,r){t.apply(null,r.concat([E((function(t,r){"object"==typeof console&&(t?console.error&&console.error(t):console[e]&&m(r,(function(t){console[e](t)})))}))]))}))}function j(e){return function(t,r,s){e(b(t),r,s)}}function B(e){return E((function(t,r){var s=E((function(r){var s=this,n=r.pop();return e(t,(function(e,t,n){e.apply(s,r.concat([n]))}),n)}));return r.length?s.apply(this,r):s}))}function U(e){return E((function(t){var r=t.pop();t.push((function(){var e=arguments;s?n.setImmediate((function(){r.apply(null,e)})):r.apply(null,e)}));var s=!0;e.apply(this,t),s=!1}))}"object"==typeof process&&"function"==typeof process.nextTick?n.nextTick=process.nextTick:n.nextTick=O,n.setImmediate=w?O:n.nextTick,n.forEach=n.each=function(e,t,r){return n.eachOf(e,R(t),r)},n.forEachSeries=n.eachSeries=function(e,t,r){return n.eachOfSeries(e,R(t),r)},n.forEachLimit=n.eachLimit=function(e,t,r,s){return T(t)(e,R(r),s)},n.forEachOf=n.eachOf=function(e,t,r){r=d(r||i);for(var s,n=x(e=e||[]),o=0;null!=(s=n());)o+=1,t(e[s],s,l(a));function a(e){o--,e?r(e):null===s&&o<=0&&r(null)}0===o&&r(null)},n.forEachOfSeries=n.eachOfSeries=function(e,t,r){r=d(r||i);var s=x(e=e||[]),o=s();!function i(){var a=!0;if(null===o)return r(null);t(e[o],o,l((function(e){if(e)r(e);else{if(null===(o=s()))return r(null);a?n.setImmediate(i):i()}}))),a=!1}()},n.forEachOfLimit=n.eachOfLimit=function(e,t,r,s){T(t)(e,r,s)},n.map=I(M),n.mapSeries=F(M),n.mapLimit=P(M),n.inject=n.foldl=n.reduce=function(e,t,r,s){n.eachOfSeries(e,(function(e,s,n){r(t,e,(function(e,r){t=r,n(e)}))}),(function(e){s(e,t)}))},n.foldr=n.reduceRight=function(e,t,r,s){var i=g(e,o).reverse();n.reduce(i,t,r,s)},n.transform=function(e,t,r,s){3===arguments.length&&(s=r,r=t,t=p(e)?[]:{}),n.eachOf(e,(function(e,s,n){r(t,e,s,n)}),(function(e){s(e,t)}))},n.select=n.filter=I(A),n.selectLimit=n.filterLimit=P(A),n.selectSeries=n.filterSeries=F(A),n.reject=I(k),n.rejectLimit=P(k),n.rejectSeries=F(k),n.any=n.some=_(n.eachOf,a,o),n.someLimit=_(n.eachOfLimit,a,o),n.all=n.every=_(n.eachOf,u,u),n.everyLimit=_(n.eachOfLimit,u,u),n.detect=_(n.eachOf,o,$),n.detectSeries=_(n.eachOfSeries,o,$),n.detectLimit=_(n.eachOfLimit,o,$),n.sortBy=function(e,t,r){function s(e,t){var r=e.criteria,s=t.criteria;return r<s?-1:r>s?1:0}n.map(e,(function(e,r){t(e,(function(t,s){t?r(t):r(null,{value:e,criteria:s})}))}),(function(e,t){if(e)return r(e);r(null,g(t.sort(s),(function(e){return e.value})))}))},n.auto=function(e,t,r){"function"==typeof arguments[1]&&(r=t,t=null),r=d(r||i);var s=S(e),o=s.length;if(!o)return r(null);t||(t=o);var a={},u=0,c=!1,l=[];function h(e){l.unshift(e)}function f(e){var t=C(l,e);t>=0&&l.splice(t,1)}function g(){o--,m(l.slice(0),(function(e){e()}))}h((function(){o||r(null,a)})),m(s,(function(s){if(!c){for(var i,o=p(e[s])?e[s]:[e[s]],l=E((function(e,t){if(u--,t.length<=1&&(t=t[0]),e){var i={};y(a,(function(e,t){i[t]=e})),i[s]=t,c=!0,r(e,i)}else a[s]=t,n.setImmediate(g)})),d=o.slice(0,o.length-1),m=d.length;m--;){if(!(i=e[d[m]]))throw new Error("Has nonexistent dependency in "+d.join(", "));if(p(i)&&C(i,s)>=0)throw new Error("Has cyclic dependencies")}b()?(u++,o[o.length-1](l,a)):h((function e(){b()&&(u++,f(e),o[o.length-1](l,a))}))}function b(){return u<t&&v(d,(function(e,t){return e&&a.hasOwnProperty(t)}),!0)&&!a.hasOwnProperty(s)}}))},n.retry=function(e,t,r){var s=5,i=0,o=[],a={times:s,interval:i};function u(e,t){if("number"==typeof t)e.times=parseInt(t,10)||s;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);e.times=parseInt(t.times,10)||s,e.interval=parseInt(t.interval,10)||i}}var c=arguments.length;if(c<1||c>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");function l(e,t){function r(e,r){return function(s){e((function(e,t){s(!e||r,{err:e,result:t})}),t)}}function s(e){return function(t){setTimeout((function(){t(null)}),e)}}for(;a.times;){var i=!(a.times-=1);o.push(r(a.task,i)),!i&&a.interval>0&&o.push(s(a.interval))}n.series(o,(function(t,r){r=r[r.length-1],(e||a.callback)(r.err,r.result)}))}return c<=2&&"function"==typeof e&&(r=t,t=e),"function"!=typeof e&&u(a,e),a.callback=r,a.task=t,a.callback?l():l},n.waterfall=function(e,t){if(t=d(t||i),!p(e)){var r=new Error("First argument to waterfall must be an array of functions");return t(r)}if(!e.length)return t();!function e(r){return E((function(s,n){if(s)t.apply(null,[s].concat(n));else{var i=r.next();i?n.push(e(i)):n.push(t),U(r).apply(null,n)}}))}(n.iterator(e))()},n.parallel=function(e,t){D(n.eachOf,e,t)},n.parallelLimit=function(e,t,r){D(T(t),e,r)},n.series=function(e,t){D(n.eachOfSeries,e,t)},n.iterator=function(e){return function t(r){function s(){return e.length&&e[r].apply(null,arguments),s.next()}return s.next=function(){return r<e.length-1?t(r+1):null},s}(0)},n.apply=E((function(e,t){return E((function(r){return e.apply(null,t.concat(r))}))})),n.concat=I(N),n.concatSeries=F(N),n.whilst=function(e,t,r){if(r=r||i,e()){var s=E((function(n,i){n?r(n):e.apply(this,i)?t(s):r.apply(null,[null].concat(i))}));t(s)}else r(null)},n.doWhilst=function(e,t,r){var s=0;return n.whilst((function(){return++s<=1||t.apply(this,arguments)}),e,r)},n.until=function(e,t,r){return n.whilst((function(){return!e.apply(this,arguments)}),t,r)},n.doUntil=function(e,t,r){return n.doWhilst(e,(function(){return!t.apply(this,arguments)}),r)},n.during=function(e,t,r){r=r||i;var s=E((function(t,s){t?r(t):(s.push(n),e.apply(this,s))})),n=function(e,n){e?r(e):n?t(s):r(null)};e(n)},n.doDuring=function(e,t,r){var s=0;n.during((function(e){s++<1?e(null,!0):t.apply(this,arguments)}),e,r)},n.queue=function(e,t){return L((function(t,r){e(t[0],r)}),t,1)},n.priorityQueue=function(e,t){function r(e,t){return e.priority-t.priority}var s=n.queue(e,t);return s.push=function(e,t,o){!function(e,t,s,o){if(null!=o&&"function"!=typeof o)throw new Error("task callback must be a function");if(e.started=!0,p(t)||(t=[t]),0===t.length)return n.setImmediate((function(){e.drain()}));m(t,(function(t){var a={data:t,priority:s,callback:"function"==typeof o?o:i};e.tasks.splice(function(e,t,r){for(var s=-1,n=e.length-1;s<n;){var i=s+(n-s+1>>>1);r(t,e[i])>=0?s=i:n=i-1}return s}(e.tasks,a,r)+1,0,a),e.tasks.length===e.concurrency&&e.saturated(),n.setImmediate(e.process)}))}(s,e,t,o)},delete s.unshift,s},n.cargo=function(e,t){return L(e,1,t)},n.log=q("log"),n.dir=q("dir"),n.memoize=function(e,t){var r={},s={},i=Object.prototype.hasOwnProperty;t=t||o;var a=E((function(o){var a=o.pop(),u=t.apply(null,o);i.call(r,u)?n.setImmediate((function(){a.apply(null,r[u])})):i.call(s,u)?s[u].push(a):(s[u]=[a],e.apply(null,o.concat([E((function(e){r[u]=e;var t=s[u];delete s[u];for(var n=0,i=t.length;n<i;n++)t[n].apply(null,e)}))])))}));return a.memo=r,a.unmemoized=e,a},n.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},n.times=j(n.map),n.timesSeries=j(n.mapSeries),n.timesLimit=function(e,t,r,s){return n.mapLimit(b(e),t,r,s)},n.seq=function(){var e=arguments;return E((function(t){var r=this,s=t[t.length-1];"function"==typeof s?t.pop():s=i,n.reduce(e,t,(function(e,t,s){t.apply(r,e.concat([E((function(e,t){s(e,t)}))]))}),(function(e,t){s.apply(r,[e].concat(t))}))}))},n.compose=function(){return n.seq.apply(null,Array.prototype.reverse.call(arguments))},n.applyEach=B(n.eachOf),n.applyEachSeries=B(n.eachOfSeries),n.forever=function(e,t){var r=l(t||i),s=U(e);!function e(t){if(t)return r(t);s(e)}()},n.ensureAsync=U,n.constant=E((function(e){var t=[null].concat(e);return function(e){return e.apply(this,t)}})),n.wrapSync=n.asyncify=function(e){return E((function(t){var r,s,n,i=t.pop();try{r=e.apply(this,t)}catch(e){return i(e)}("function"===(n=typeof(s=r))||"object"===n&&s)&&"function"==typeof r.then?r.then((function(e){i(null,e)})).catch((function(e){i(e.message?e:new Error(e))})):i(null,r)}))},e.exports?e.exports=n:void 0===(s=function(){return n}.apply(t,[]))||(e.exports=s)}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5),n=r(2),i=r(0),o=r(7).sync,a=["JLinkGDBServerCLExe","JLinkGDBServerCL","JLinkGDBServer"];class u extends i.EventEmitter{constructor(){super(),this.portsNeeded=["gdbPort","swoPort","consolePort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,r){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports.gdbPort}`]}launchCommands(){return['interpreter-exec console "monitor halt"','interpreter-exec console "monitor reset"',"target-download",'interpreter-exec console "monitor reset"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor halt"','interpreter-exec console "monitor reset"']}swoCommands(){const e=[];if(this.args.swoConfig.enabled){const t=this.SWOConfigurationCommands();e.push(...t)}return e}SWOConfigurationCommands(){const e="0x"+s.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=0|this.args.swoConfig.swoFrequency,r=[`monitor SWO EnableTarget ${0|this.args.swoConfig.cpuFrequency} ${t} ${e} 0`,"DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable"];return r.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),r.map(e=>`interpreter-exec console "${e}"`)}serverExecutable(){if(this.args.serverpath)return this.args.serverpath;if("win32"===n.platform())return"JLinkGDBServerCL.exe";for(const e in a)if(o(e))return e;return"JLinkGDBServer"}serverArguments(){const e=this.ports.gdbPort,t=this.ports.swoPort,r=this.ports.consolePort;let s=["-if",this.args.interface,"-port",e.toString(),"-swoport",t.toString(),"-telnetport",r.toString(),"-device",this.args.device];return this.args.serialNumber?s.push("-select",`usb=${this.args.serialNumber}`):this.args.ipAddress&&s.push("-select",`ip=${this.args.ipAddress}`),this.args.rtos&&s.push("-rtos",this.args.rtos),this.args.jlinkscript&&s.push("-jlinkscriptfile",this.args.jlinkscript),this.args.serverArgs&&(s=s.concat(this.args.serverArgs)),s}initMatch(){return/Waiting for GDB connection\.\.\./g}serverLaunchStarted(){}serverLaunchCompleted(){this.args.swoConfig.enabled&&("probe"===this.args.swoConfig.source?this.emit("event",new s.SWOConfigureEvent({type:"socket",port:this.ports.swoPort})):this.emit("event",new s.SWOConfigureEvent({type:"serial",device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency})))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.JLinkServerController=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5),n=r(2),i=r(48),o=r(3),a=r(4),u=r(0);class c extends u.EventEmitter{constructor(){super(),this.portsNeeded=["gdbPort"],this.name="OpenOCD",this.swoPath=i.tmpNameSync()}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,r){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports.gdbPort}`]}launchCommands(){return['interpreter-exec console "monitor reset halt"',"target-download",'interpreter-exec console "monitor reset halt"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor reset halt"']}swoCommands(){const e=[];if(this.args.swoConfig.enabled){const t=this.SWOConfigurationCommands();e.push(...t)}return e}SWOConfigurationCommands(){const e="0x"+s.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=this.args.swoConfig.swoFrequency,r=this.args.swoConfig.cpuFrequency,n=["EnableITMAccess",`BaseSWOSetup ${Math.floor(r/t)-1}`,"SetITMId 1","ITMDWTTransferEnable","DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable","ITMGlobalEnable"];return n.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),n.map(e=>`interpreter-exec console "${e}"`)}serverExecutable(){return this.args.serverpath?this.args.serverpath:"win32"===n.platform()?"openocd.exe":"openocd"}serverArguments(){const e=this.ports.gdbPort;let t=[];t.push("-c",`gdb_port ${e}`),this.args.searchDir.forEach((e,r)=>{t.push("-s",e)}),0===this.args.searchDir.length&&t.push("-s",this.args.cwd);for(const e of this.args.openOCDPreConfigLaunchCommands||[])t.push("-c",e);if(this.args.configFiles.forEach((e,r)=>{t.push("-f",e)}),this.args.rtos){const e=i.tmpNameSync();o.writeFileSync(e,`$_TARGETNAME configure -rtos ${this.args.rtos}\n`,"utf8"),t.push("-f",e)}this.args.serverArgs&&(t=t.concat(this.args.serverArgs));const r=[];if(this.args.swoConfig.enabled){let e;"win32"===n.platform()&&(this.swoPath=this.swoPath.replace(/\\/g,"/")),e="probe"===this.args.swoConfig.source?`internal ${this.swoPath}`:"external",r.push(`tpiu config ${e} uart off ${this.args.swoConfig.cpuFrequency} ${this.args.swoConfig.swoFrequency}`)}r.length>0&&t.push("-c",r.join("; "));for(const e of this.args.openOCDLaunchCommands||[])t.push("-c",e);return t}initMatch(){return/Info\s:[^\n]*Listening on port \d+ for gdb connection/i}serverLaunchStarted(){if(this.args.swoConfig.enabled&&"probe"===this.args.swoConfig.source&&"win32"!==n.platform()){a.spawnSync("mkfifo",[this.swoPath]);this.emit("event",new s.SWOConfigureEvent({type:"fifo",path:this.swoPath}))}}serverLaunchCompleted(){this.args.swoConfig.enabled&&("probe"===this.args.swoConfig.source&&"win32"===n.platform()?this.emit("event",new s.SWOConfigureEvent({type:"file",path:this.swoPath})):"probe"!==this.args.swoConfig.source&&this.emit("event",new s.SWOConfigureEvent({type:"serial",device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency})))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.OpenOCDServerController=c},function(e,t,r){
/*!
 * Tmp
 *
 * Copyright (c) 2011-2017 KARASZI Istvan <github@spam.raszi.hu>
 *
 * MIT Licensed
 */
const s=r(3),n=r(1),i=r(18),o=r(49),a=process.binding("constants"),u=o(),c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",l=/XXXXXX/,d=(a.O_CREAT||a.fs.O_CREAT)|(a.O_EXCL||a.fs.O_EXCL)|(a.O_RDWR||a.fs.O_RDWR),h=a.EBADF||a.os.errno.EBADF,p=a.ENOENT||a.os.errno.ENOENT,f=[];var m=!1,g=!1;function b(e){var t=[],r=null;try{r=i.randomBytes(e)}catch(t){r=i.pseudoRandomBytes(e)}for(var s=0;s<e;s++)t.push(c[r[s]%c.length]);return t.join("")}function v(e){return void 0===e}function y(e,t){return"function"==typeof e?[t||{},e]:v(e)?[{},t]:[e,t]}function C(e){if(e.name)return n.join(e.dir||u,e.name);if(e.template)return e.template.replace(l,b(6));const t=[e.prefix||"tmp-",process.pid,b(12),e.postfix||""].join("");return n.join(e.dir||u,t)}function S(e,t){var r=y(e,t),n=r[0],i=r[1],o=n.name?1:n.tries||3;return isNaN(o)||o<0?i(new Error("Invalid tries")):n.template&&!n.template.match(l)?i(new Error("Invalid template provided")):void function e(){const t=C(n);s.stat(t,(function(r){if(!r)return o-- >0?e():i(new Error("Could not get a unique tmp filename, max tries reached "+t));i(null,t)}))}()}function x(e){var t=y(e)[0],r=t.name?1:t.tries||3;if(isNaN(r)||r<0)throw new Error("Invalid tries");if(t.template&&!t.template.match(l))throw new Error("Invalid template provided");do{const e=C(t);try{s.statSync(e)}catch(t){return e}}while(r-- >0);throw new Error("Could not get a unique tmp filename, max tries reached")}function E(e){const t=[e];do{for(var r=t.pop(),i=!1,o=s.readdirSync(r),a=0,u=o.length;a<u;a++){var c=n.join(r,o[a]);s.lstatSync(c).isDirectory()?(i||(i=!0,t.push(r)),t.push(c)):s.unlinkSync(c)}i||s.rmdirSync(r)}while(0!==t.length)}function R(e,t,r){const n=O((function(e){try{0<=e[0]&&s.closeSync(e[0])}catch(e){if(!P(e,-h,"EBADF")&&!I(e))throw e}try{s.unlinkSync(e[1])}catch(e){if(!I(e))throw e}}),[t,e]);return r.keep||f.unshift(n),n}function w(e,t){const r=O(t.unsafeCleanup?E:s.rmdirSync.bind(s),e);return t.keep||f.unshift(r),r}function O(e,t){var r=!1;return function s(n){if(!r){const n=f.indexOf(s);n>=0&&f.splice(n,1),r=!0,e(t)}n&&n(null)}}function T(){if(!g||m)for(;f.length;)try{f[0].call(null)}catch(e){}}function I(e){return P(e,-p,"ENOENT")}function P(e,t,r){return e.code==t||e.code==r}const F=process.versions.node.split(".").map((function(e){return parseInt(e,10)}));0===F[0]&&(F[1]<9||9===F[1]&&F[2]<5)&&process.addListener("uncaughtException",(function(e){throw g=!0,T(),e})),process.addListener("exit",(function(e){e&&(g=!0),T()})),e.exports.tmpdir=u,e.exports.dir=function(e,t){var r=y(e,t),n=r[0],i=r[1];S(n,(function(e,t){if(e)return i(e);s.mkdir(t,n.mode||448,(function(e){if(e)return i(e);i(null,t,w(t,n))}))}))},e.exports.dirSync=function(e){var t=y(e)[0];const r=x(t);return s.mkdirSync(r,t.mode||448),{name:r,removeCallback:w(r,t)}},e.exports.file=function(e,t){var r=y(e,t),n=r[0],i=r[1];n.postfix=v(n.postfix)?".tmp":n.postfix,S(n,(function(e,t){if(e)return i(e);s.open(t,d,n.mode||384,(function(e,r){return e?i(e):n.discardDescriptor?s.close(r,(function(e){if(e){try{s.unlinkSync(t)}catch(t){I(t)||(e=t)}return i(e)}i(null,t,void 0,R(t,-1,n))})):n.detachDescriptor?i(null,t,r,R(t,-1,n)):void i(null,t,r,R(t,r,n))}))}))},e.exports.fileSync=function(e){var t=y(e)[0];t.postfix=t.postfix||".tmp";const r=t.discardDescriptor||t.detachDescriptor,n=x(t);var i=s.openSync(n,d,t.mode||384);return t.discardDescriptor&&(s.closeSync(i),i=void 0),{name:n,fd:i,removeCallback:R(n,r?-1:i,t)}},e.exports.tmpName=S,e.exports.tmpNameSync=x,e.exports.setGracefulCleanup=function(){m=!0}},function(e,t,r){"use strict";var s="win32"===process.platform,n=s?/[^:]\\$/:/.\/$/;e.exports=function(){var e;return e=s?process.env.TEMP||process.env.TMP||(process.env.SystemRoot||process.env.windir)+"\\temp":process.env.TMPDIR||process.env.TMP||process.env.TEMP||"/tmp",n.test(e)&&(e=e.slice(0,-1)),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5),n=r(2),i=r(0);class o extends i.EventEmitter{constructor(){super(),this.name="ST-Util",this.portsNeeded=["gdbPort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,r){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports.gdbPort}`]}launchCommands(){return['interpreter-exec console "monitor halt"','interpreter-exec console "monitor reset"',"target-download",'interpreter-exec console "monitor reset"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor halt"','interpreter-exec console "monitor reset"']}swoCommands(){const e=[];if(this.args.swoConfig.enabled&&"probe"!==this.args.swoConfig.source){const t=this.SWOConfigurationCommands();e.push(...t)}return e}SWOConfigurationCommands(){const e="0x"+s.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=this.args.swoConfig.swoFrequency,r=this.args.swoConfig.cpuFrequency,n=["EnableITMAccess",`BaseSWOSetup ${Math.floor(r/t)-1}`,"SetITMId 1","ITMDWTTransferEnable","DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable","ITMGlobalEnable"];return n.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),n.map(e=>`interpreter-exec console "${e}"`)}serverExecutable(){return this.args.serverpath?this.args.serverpath:"win32"===n.platform()?"st-util.exe":"st-util"}serverArguments(){let e=["-p",this.ports.gdbPort.toString(),"-v","--no-reset"];return this.args.v1&&e.push("--stlinkv1"),this.args.serverArgs&&(e=e.concat(this.args.serverArgs)),e}initMatch(){return/Listening at \*/g}serverLaunchStarted(){}serverLaunchCompleted(){this.args.swoConfig.enabled&&"probe"!==this.args.swoConfig.source&&this.emit("event",new s.SWOConfigureEvent({type:"serial",device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency}))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.STUtilServerController=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5),n=r(0);class i extends n.EventEmitter{constructor(){super(),this.name="PyOCD",this.portsNeeded=["gdbPort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,r){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports.gdbPort}`]}launchCommands(){return['interpreter-exec console "monitor reset halt"',"target-download",'interpreter-exec console "monitor reset halt"',"enable-pretty-printing"]}attachCommands(){this.ports.gdbPort;return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor reset"']}swoCommands(){const e=[];if(this.args.swoConfig.enabled&&"probe"!==this.args.swoConfig.source){const t=this.SWOConfigurationCommands();e.push(...t)}return e}SWOConfigurationCommands(){const e="0x"+s.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=this.args.swoConfig.swoFrequency,r=this.args.swoConfig.cpuFrequency,n=["EnableITMAccess",`BaseSWOSetup ${Math.floor(r/t)-1}`,"SetITMId 1","ITMDWTTransferEnable","DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable","ITMGlobalEnable"];return n.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),n.map(e=>`interpreter-exec console "${e}"`)}serverExecutable(){return this.args.serverpath?this.args.serverpath:"pyocd-gdbserver"}serverArguments(){let e=["--persist","--port",this.ports.gdbPort.toString(),"--reset-break"];return this.args.boardId&&(e.push("--board"),e.push(this.args.boardId)),this.args.targetId&&(e.push("--target"),e.push(this.args.targetId.toString())),this.args.cmsisPack&&(e.push("--pack"),e.push(this.args.cmsisPack.toString())),this.args.serverArgs&&(e=e.concat(this.args.serverArgs)),e}initMatch(){return/GDB server started (at|on) port/}serverLaunchStarted(){}serverLaunchCompleted(){this.args.swoConfig.enabled&&"probe"!==this.args.swoConfig.source&&this.emit("event",new s.SWOConfigureEvent({type:"serial",device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency}))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.PyOCDServerController=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(5),n=r(0);class i extends n.EventEmitter{constructor(){super(),this.name="BMP",this.portsNeeded=[]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,r){return!1}initCommands(){const e=[`target-select extended-remote ${this.args.BMPGDBSerialPort}`];return"enable"===this.args.powerOverBMP?(e.push('interpreter-exec console "monitor tpwr enable"'),e.push('interpreter-exec console "shell sleep 0.1"')):"disable"===this.args.powerOverBMP&&e.push('interpreter-exec console "monitor tpwr disable"'),"jtag"===this.args.interface?e.push('interpreter-exec console "monitor jtag_scan"'):e.push('interpreter-exec console "monitor swdp_scan"'),e.push(`interpreter-exec console "attach ${this.args.targetId}"`,'interpreter-exec console "set mem inaccessible-by-default off"'),e}launchCommands(){return["target-download",'interpreter-exec console "SoftwareReset"',"enable-pretty-printing"]}attachCommands(){return["enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "SoftwareReset"']}swoCommands(){const e=[];if(this.args.swoConfig.enabled){const t=this.SWOConfigurationCommands();e.push(...t)}return e}SWOConfigurationCommands(){const e="0x"+s.calculatePortMask(this.args.swoConfig.decoders).toString(16),t=this.args.swoConfig.swoFrequency,r=this.args.swoConfig.cpuFrequency,n=Math.floor(r/t)-1,i=[];return i.push("EnableITMAccess",`BaseSWOSetup ${n}`,"SetITMId 1","ITMDWTTransferEnable","DisableITMPorts 0xFFFFFFFF",`EnableITMPorts ${e}`,"EnableDWTSync","ITMSyncEnable","ITMGlobalEnable"),i.push(this.args.swoConfig.profile?"EnablePCSample":"DisablePCSample"),i.map(e=>`interpreter-exec console "${e}"`)}serverExecutable(){return null}serverArguments(){return[]}initMatch(){return null}serverLaunchStarted(){}serverLaunchCompleted(){this.args.swoConfig.enabled&&"probe"!==this.args.swoConfig.source&&this.emit("event",new s.SWOConfigureEvent({type:"serial",device:this.args.swoConfig.source,baudRate:this.args.swoConfig.swoFrequency}))}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.BMPServerController=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(2),n=r(0);r(7).sync;class i extends n.EventEmitter{constructor(){super(),this.portsNeeded=["gdbPort","swoPort","consolePort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,r){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports.gdbPort}`]}launchCommands(){return['interpreter-exec console "monitor _reset"',"target-download",'interpreter-exec console "monitor _reset"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor _reset"']}swoCommands(){return[]}serverExecutable(){return console.log("Getting Exec"),this.args.serverpath?this.args.serverpath:"win32"===s.platform()?"pegdbserver_console.exe":"pegdbserver_console"}serverArguments(){const e=this.ports.gdbPort;let t=[];return t.push("-startserver"),t.push("-singlesession"),t.push(`-device=${this.args.device}`),t.push(`-serverport=${e}`),this.args.ipAddress&&t.push(`-serverip=${this.args.ipAddress}`),this.args.rtos&&t.push(`-kernal=${this.args.rtos}`),this.args.interface&&t.push(`-interface=${this.args.interface}`),this.args.configFiles&&t.push(`-configfile=${this.args.configFiles[0]}`),this.args.serverArgs&&(t=t.concat(this.args.serverArgs)),t}initMatch(){return/All Servers Running/g}serverLaunchStarted(){}serverLaunchCompleted(){}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.PEServerController=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),n=r(7).sync,i=["qemu-system-arm"];class o extends s.EventEmitter{constructor(){super(),this.portsNeeded=["gdbPort"]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,r){return!1}initCommands(){return[`target-select extended-remote localhost:${this.ports.gdbPort}`]}launchCommands(){return["enable-pretty-printing"]}attachCommands(){return["enable-pretty-printing"]}restartCommands(){return['interpreter-exec console "monitor stop"','interpreter-exec console "monitor system_reset"']}swoCommands(){return[]}serverExecutable(){if(this.args.serverpath)return this.args.serverpath;for(const e in i)if(n(e))return e;return"qemu-system-arm"}serverArguments(){const e=this.ports.gdbPort;let t=["-cpu",this.args.cpu,"-machine",this.args.machine,"-nographic","-semihosting-config","enable=on,target=native","-gdb","tcp::"+e.toString(),"-S","-kernel",this.args.executable];return this.args.serverArgs&&(t=t.concat(this.args.serverArgs)),t}initMatch(){return null}serverLaunchStarted(){}serverLaunchCompleted(){}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.QEMUServerController=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(0);class n extends s.EventEmitter{constructor(){super(),this.name="External",this.portsNeeded=[]}setPorts(e){this.ports=e}setArguments(e){this.args=e}customRequest(e,t,r){return!1}initCommands(){return[`target-select extended-remote ${this.args.gdbTarget}`]}launchCommands(){return['interpreter-exec console "monitor reset halt"',"target-download",'interpreter-exec console "monitor reset halt"',"enable-pretty-printing"]}attachCommands(){return['interpreter-exec console "monitor halt"',"enable-pretty-printing"]}swoCommands(){return[]}restartCommands(){return['interpreter-exec console "monitor reset halt"']}serverExecutable(){return null}serverArguments(){return[]}initMatch(){return null}serverLaunchStarted(){}serverLaunchCompleted(){}debuggerLaunchStarted(){}debuggerLaunchCompleted(){}}t.ExternalServerController=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=r(4),n=r(2),i=r(1),o=r(19),a=/^([0-9a-f]{8})\s([lg\ !])([w\ ])([C\ ])([W\ ])([I\ ])([dD\ ])([FfO\ ])\s([^\s]+)\s([0-9a-f]+)\s(.*)$/,u={F:o.SymbolType.Function,f:o.SymbolType.File,O:o.SymbolType.Object," ":o.SymbolType.Normal},c={l:o.SymbolScope.Local,g:o.SymbolScope.Global," ":o.SymbolScope.Neither,"!":o.SymbolScope.Both};t.SymbolTable=class{constructor(e,t,r,s){this.toolchainPath=e,this.toolchainPrefix=t,this.executable=r,this.demangle=s,this.allSymbols=[],this.staticsByFile={},this.globalVars=[],this.globalFuncs=[],this.staticVars=[],this.staticFuncs=[],this.fileMap={}}loadSymbols(){try{let e="win32"!==n.platform()?`${this.toolchainPrefix}-objdump`:`${this.toolchainPrefix}-objdump.exe`;this.toolchainPath&&(e=i.normalize(i.join(this.toolchainPath,e)));const t=["--syms","-Wi"];this.demangle&&t.push("-C");const r=s.spawnSync(e,[...t,this.executable]).stdout.toString().split(/[\r\n]+/g);this.collectCompilationUnits(r);let l=null,d=null;for(const e of r){const t=e.match(a);if(t){"d"===t[7]&&"f"===t[8]&&(t[11]?(l=t[11].trim(),d=this.addToFileMap(l.split("/").pop(),l)):(l=null,d=null));const e=u[t[8]],r=c[t[2]];let s=t[11].trim(),n=!1;s.startsWith(".hidden")&&(s=s.substring(7).trim(),n=!0);const i={address:parseInt(t[1],16),type:e,origScope:r,scope:r,section:t[9].trim(),length:parseInt(t[10],16),name:s,file:r===o.SymbolScope.Local?l:null,fileMaps:r===o.SymbolScope.Local?d:[],instructions:null,hidden:n};this.allSymbols.push(i),r!==o.SymbolScope.Local?e===o.SymbolType.Function?(i.scope=o.SymbolScope.Global,this.globalFuncs.push(i)):e===o.SymbolType.Object&&(r===o.SymbolScope.Global?this.globalVars.push(i):console.log("SymbolTable: ignoring non local object: "+s)):l?e===o.SymbolType.Object?this.staticVars.push(i):e===o.SymbolType.Function&&this.staticFuncs.push(i):e===o.SymbolType.Function?(i.scope=o.SymbolScope.Global,this.globalFuncs.push(i)):e===o.SymbolType.Object&&console.log("SymbolTable: ignoring local object: "+s)}}}catch(e){}}addToFileMap(e,t){const r=this.fileMap[e]||[];return-1===r.indexOf(t)&&r.push(t),this.fileMap[e]=r,r}collectCompilationUnits(e){let t=!1,r="",s="",n="";const i=/^ <0>.*Abbrev Number.*\(DW_TAG_compile_unit\)/;for(const o of e)if(i.test(o))t=!0;else if(t){const e=o.match(/.*DW_AT_([^\s]*).*\)\:\s(.*)/);e?"name"===e[1]?(r=e[2],n=r.split("/").pop(),this.addToFileMap(n,n),this.addToFileMap(n,r)):"comp_dir"===e[1]&&(s=e[2],""!==r&&this.addToFileMap(n,s+"/"+r)):o.startsWith(" <")&&(t=!1,n=r=s="")}}getFunctionAtAddress(e){return this.allSymbols.find(t=>t.type===o.SymbolType.Function&&t.address<=e&&t.address+t.length>e)}getFunctionSymbols(){return this.allSymbols.filter(e=>e.type===o.SymbolType.Function)}getGlobalVariables(){return this.globalVars}getStaticVariables(e){let t=this.staticsByFile[e];if(!t){t=[];for(const r of this.staticVars)-1!==r.fileMaps.indexOf(e)&&t.push(r);this.staticsByFile[e]=t}return t}getFunctionByName(e,t){if(t){for(const r of this.staticFuncs)if(r.name===e&&r.file===t)return r;for(const r of this.staticFuncs)if(r.name===e&&-1!==r.fileMaps.indexOf(t))return r}return this.globalFuncs.find(t=>t.name===e)}}}]);
//# sourceMappingURL=debugadapter.js.map